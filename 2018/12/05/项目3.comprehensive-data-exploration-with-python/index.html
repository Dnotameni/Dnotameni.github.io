<!DOCTYPE html><html lang="zh-Hans"><head><meta http-equiv="content-type" content="text/html; charset=utf-8"><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="black-translucent" name="apple-mobile-web-app-status-bar-style"><meta content="telephone=no" name="format-detection"><meta name="description" content="好的量变引起质变"><title>项目学习3.Kaggle利用python对数据的探索性理解 | DnoBlog</title><link rel="stylesheet" type="text/css" href="/css/style.css?v=0.0.0"><link rel="stylesheet" type="text/css" href="//lib.baomitu.com/normalize/8.0.1/normalize.min.css"><link rel="stylesheet" type="text/css" href="//lib.baomitu.com/pure/1.0.0/pure-min.css"><link rel="stylesheet" type="text/css" href="//lib.baomitu.com/pure/1.0.0/grids-responsive-min.css"><link rel="stylesheet" href="//lib.baomitu.com/font-awesome/4.7.0/css/font-awesome.min.css"><script type="text/javascript" src="//lib.baomitu.com/jquery/3.3.1/jquery.min.js"></script><link rel="icon" mask="" sizes="any" href="/favicon.ico"><link rel="Shortcut Icon" type="image/x-icon" href="/favicon.ico"><link rel="apple-touch-icon" href="/apple-touch-icon.png"><link rel="apple-touch-icon-precomposed" href="/apple-touch-icon.png"></head><body><div class="body_container"><div id="header"><div class="site-name"><h1 class="hidden">项目学习3.Kaggle利用python对数据的探索性理解</h1><a id="logo" href="/.">DnoBlog</a><p class="description">学会思考</p></div><div id="nav-menu"><a class="current" href="/."><i class="fa fa-home"> 首页</i></a><a href="/archives/"><i class="fa fa-archive"> 归档</i></a><a href="/about/"><i class="fa fa-user"> 关于</i></a></div></div><div class="pure-g" id="layout"><div class="pure-u-1 pure-u-md-3-4"><div class="content_container"><div class="post"><h1 class="post-title">项目学习3.Kaggle利用python对数据的探索性理解</h1><div class="post-meta">Dec 5, 2018<span> | </span><span class="category"><a href="/categories/🐍python/">🐍python</a><a href="/categories/🐍python/项目学习/">项目学习</a></span></div><div class="clear"><div class="toc-article" id="toc"><div class="toc-title">Inhalte</div><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#1-我们希望得到什么？"><span class="toc-number">1.</span> <span class="toc-text">1 我们希望得到什么？</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#2-首先分析SalePrice变量，是我们的问题的目标。"><span class="toc-number">2.</span> <span class="toc-text">2 首先分析SalePrice变量，是我们的问题的目标。</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#3"><span class="toc-number">3.</span> <span class="toc-text">3</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#4-缺失数据"><span class="toc-number">4.</span> <span class="toc-text">4. 缺失数据</span></a></li></ol></div></div><div class="post-content"><p><a href="https://www.kaggle.com/pmarcelino/comprehensive-data-exploration-with-python" target="_blank" rel="noopener">https://www.kaggle.com/pmarcelino/comprehensive-data-exploration-with-python</a></p>
<ol>
<li>Understand the problem#. We’ll look at each variable and do a philosophical analysis about their meaning and importance for this problem.<br> 了解问题</li>
<li>Univariable study#. We’ll just focus on the dependent variable (‘SalePrice’) and try to know a little bit more about it.<br> 单变量分析</li>
<li>Multivariate study#. We’ll try to understand how the dependent variable and independent variables relate.<br> 多变量分析</li>
<li>Basic cleaning#. We’ll clean the dataset and handle the missing data, outliers and categorical variables.<br> 基本清洗</li>
<li>Test assumptions#. We’ll check if our data meets the assumptions required by most multivariate techniques.<br> 假设检验</li>
</ol>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#导入数据</span></span><br><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"><span class="keyword">import</span> seaborn <span class="keyword">as</span> sns</span><br><span class="line"><span class="keyword">from</span> scipy.stats <span class="keyword">import</span> norm</span><br><span class="line"><span class="keyword">from</span> sklearn.preprocessing <span class="keyword">import</span> StandardScaler</span><br><span class="line"><span class="keyword">from</span> scipy <span class="keyword">import</span> stats</span><br><span class="line">%matplotlib inline</span><br><span class="line"></span><br><span class="line">df_train = pd.read_csv(<span class="string">r'C:\C\Python\all\House Prices Advanced Regression Techniques\train.csv'</span>)</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#查看数据大致情况</span></span><br><span class="line">df_train.columns</span><br></pre></td></tr></table></figure>
<a id="more"></a>
<pre><code>Index([&apos;Id&apos;, &apos;MSSubClass&apos;, &apos;MSZoning&apos;, &apos;LotFrontage&apos;, &apos;LotArea&apos;, &apos;Street&apos;,
       &apos;Alley&apos;, &apos;LotShape&apos;, &apos;LandContour&apos;, &apos;Utilities&apos;, &apos;LotConfig&apos;,
       &apos;LandSlope&apos;, &apos;Neighborhood&apos;, &apos;Condition1&apos;, &apos;Condition2&apos;, &apos;BldgType&apos;,
       &apos;HouseStyle&apos;, &apos;OverallQual&apos;, &apos;OverallCond&apos;, &apos;YearBuilt&apos;, &apos;YearRemodAdd&apos;,
       &apos;RoofStyle&apos;, &apos;RoofMatl&apos;, &apos;Exterior1st&apos;, &apos;Exterior2nd&apos;, &apos;MasVnrType&apos;,
       &apos;MasVnrArea&apos;, &apos;ExterQual&apos;, &apos;ExterCond&apos;, &apos;Foundation&apos;, &apos;BsmtQual&apos;,
       &apos;BsmtCond&apos;, &apos;BsmtExposure&apos;, &apos;BsmtFinType1&apos;, &apos;BsmtFinSF1&apos;,
       &apos;BsmtFinType2&apos;, &apos;BsmtFinSF2&apos;, &apos;BsmtUnfSF&apos;, &apos;TotalBsmtSF&apos;, &apos;Heating&apos;,
       &apos;HeatingQC&apos;, &apos;CentralAir&apos;, &apos;Electrical&apos;, &apos;1stFlrSF&apos;, &apos;2ndFlrSF&apos;,
       &apos;LowQualFinSF&apos;, &apos;GrLivArea&apos;, &apos;BsmtFullBath&apos;, &apos;BsmtHalfBath&apos;, &apos;FullBath&apos;,
       &apos;HalfBath&apos;, &apos;BedroomAbvGr&apos;, &apos;KitchenAbvGr&apos;, &apos;KitchenQual&apos;,
       &apos;TotRmsAbvGrd&apos;, &apos;Functional&apos;, &apos;Fireplaces&apos;, &apos;FireplaceQu&apos;, &apos;GarageType&apos;,
       &apos;GarageYrBlt&apos;, &apos;GarageFinish&apos;, &apos;GarageCars&apos;, &apos;GarageArea&apos;, &apos;GarageQual&apos;,
       &apos;GarageCond&apos;, &apos;PavedDrive&apos;, &apos;WoodDeckSF&apos;, &apos;OpenPorchSF&apos;,
       &apos;EnclosedPorch&apos;, &apos;3SsnPorch&apos;, &apos;ScreenPorch&apos;, &apos;PoolArea&apos;, &apos;PoolQC&apos;,
       &apos;Fence&apos;, &apos;MiscFeature&apos;, &apos;MiscVal&apos;, &apos;MoSold&apos;, &apos;YrSold&apos;, &apos;SaleType&apos;,
       &apos;SaleCondition&apos;, &apos;SalePrice&apos;],
      dtype=&apos;object&apos;)
</code></pre><h1 id="1-我们希望得到什么？"><a href="#1-我们希望得到什么？" class="headerlink" title="1 我们希望得到什么？"></a>1 我们希望得到什么？</h1><p>为了了解数据，分析规则表：</p>
<ol>
<li>变量- 变量名</li>
<li>类型- 变量类型：数值型 类别型</li>
<li>细分- 变量细分的识别。 我们可以定义三个可能的部分：建筑，空间或位置。 当我们说’建筑’时，我们指的是与建筑物的物理特征相关的变量（例如’OverallQual’）。 当我们说’空间’时，我们指的是一个报告房屋空间属性的变量（例如’TotalBsmtSF’）。 最后，当我们说“位置”时，我们指的是一个变量，它提供有关房屋所在位置的信息（例如“邻居”</li>
<li>期望- 我们对“销售价格”变量影响的期望。我们可以使用“高”、“中”和“低”作为可能值的分类量表</li>
<li>结论- 在我们快速查看数据之后，我们对变量重要性的结论。 我们可以保持与“期望”中相同的分类标度。</li>
<li>评论- 任何我们想到的一般性评论</li>
</ol>
<p>为了填满这一栏，我们应该阅读所有变量的描述，然后一个接一个地问自己:<br>我们在买房的时候会考虑这个变量吗?例:当我们想到我们梦想中的房子时，我们会在意它的“砖石贴面类型”吗?<br>如果是，这个变量有多重要?例:拥有“优秀”材料而不是“差”材料对外观有什么影响?以及用“Excellent”而不是“Good”?<br>这个信息已经在其他变量中描述过了吗?例:如果“LandContour”给出了物业的平整度，我们真的需要知道“LandSlope”？）</p>
<p>目的：了解数据 找出哪几个变量重要</p>
<p>I went through this process and concluded that the following variables can play an important role in this problem:</p>
<ul>
<li>OverallQual (which is a variable that I don’t like because I don’t know how it was computed; a funny exercise would be to predict ‘OverallQual’ using all the other variables available).</li>
<li>YearBuilt.</li>
<li>TotalBsmtSF.</li>
<li>GrLivArea.</li>
</ul>
<h1 id="2-首先分析SalePrice变量，是我们的问题的目标。"><a href="#2-首先分析SalePrice变量，是我们的问题的目标。" class="headerlink" title="2 首先分析SalePrice变量，是我们的问题的目标。"></a>2 首先分析SalePrice变量，是我们的问题的目标。</h1><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">#统计描述</span></span><br><span class="line">df_train[<span class="string">'SalePrice'</span>].describe()</span><br><span class="line"></span><br><span class="line"><span class="comment">#直方图分布</span></span><br><span class="line">sns.distplot(df_train[<span class="string">'SalePrice'</span>]);</span><br></pre></td></tr></table></figure>
<pre><code>C:\Users\35038\Anaconda3\lib\site-packages\scipy\stats\stats.py:1713: FutureWarning: Using a non-tuple sequence for multidimensional indexing is deprecated; use `arr[tuple(seq)]` instead of `arr[seq]`. In the future this will be interpreted as an array index, `arr[np.array(seq)]`, which will result either in an error or a different result.
  return np.add.reduce(sorted[indexer] * weights, axis=axis) / sumval
</code></pre><p><img src="/images/output_6_1.png" alt="png"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">'''Deviate from the normal distribution.</span></span><br><span class="line"><span class="string">   Have appreciable positive skewness.右偏</span></span><br><span class="line"><span class="string">   Show peakedness.尖峰'''</span></span><br></pre></td></tr></table></figure>
<pre><code>&apos;Deviate from the normal distribution.\n   Have appreciable positive skewness.右偏\n   Show peakedness.尖峰&apos;
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#偏度和峰值</span></span><br><span class="line">print(<span class="string">'Skewness: %f'</span> % df_train[<span class="string">'SalePrice'</span>].skew())</span><br><span class="line">print(<span class="string">'Kurtosis: %f'</span> % df_train[<span class="string">'SalePrice'</span>].kurt())</span><br></pre></td></tr></table></figure>
<pre><code>Skewness: 1.882876
Kurtosis: 6.536282
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#与数值变量的关系</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#GrLivArea 和 SalePrice的散点图</span></span><br><span class="line">var = <span class="string">'GrLivArea'</span></span><br><span class="line">data = pd.concat([df_train[<span class="string">'SalePrice'</span>],df_train[var]],axis = <span class="number">1</span>)</span><br><span class="line">data.plot.scatter(x=var,y=<span class="string">'SalePrice'</span>,ylim=(<span class="number">0</span>,<span class="number">800000</span>))</span><br></pre></td></tr></table></figure>
<pre><code>&lt;matplotlib.axes._subplots.AxesSubplot at 0x1f14c5dc278&gt;
</code></pre><p><img src="/images/output_9_1.png" alt="png"></p>
<p>看起来二者有线性关系</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#TotalBsmtSF 和SalePrice的散点图</span></span><br><span class="line">var = <span class="string">'TotalBsmtSF'</span></span><br><span class="line">data = pd.concat([df_train[<span class="string">'SalePrice'</span>],df_train[var]],axis =<span class="number">1</span>)</span><br><span class="line">data.plot.scatter(x=var,y=<span class="string">'SalePrice'</span>,ylim=(<span class="number">0</span>,<span class="number">800000</span>))</span><br></pre></td></tr></table></figure>
<pre><code>&lt;matplotlib.axes._subplots.AxesSubplot at 0x1f14c68d390&gt;
</code></pre><p><img src="/images/output_11_1.png" alt="png"></p>
<p>看起来也有很强烈的线性关系 或者 指数关系；此外还有一些为0的值</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#与类别变量的关系</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#OverallQual和SalePrice的箱型图</span></span><br><span class="line">var= <span class="string">'OverallQual'</span></span><br><span class="line">data = pd.concat([df_train[<span class="string">'SalePrice'</span>],df_train[var]],axis=<span class="number">1</span>)</span><br><span class="line">f, ax = plt.subplots(figsize=(<span class="number">8</span>,<span class="number">6</span>))</span><br><span class="line">fig = sns.boxplot(x=var,y=<span class="string">'SalePrice'</span>,data=data)</span><br><span class="line">fig.axis(ymin=<span class="number">0</span>,ymax=<span class="number">800000</span>)</span><br></pre></td></tr></table></figure>
<pre><code>(-0.5, 9.5, 0, 800000)
</code></pre><p><img src="/images/output_13_1.png" alt="png"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">var = <span class="string">'YearBuilt'</span></span><br><span class="line">data = pd.concat([df_train[<span class="string">'SalePrice'</span>],df_train[var]],axis=<span class="number">1</span>)</span><br><span class="line">f,ax = plt.subplots(figsize=(<span class="number">16</span>,<span class="number">8</span>))</span><br><span class="line">fig = sns.boxplot(x=var,y= <span class="string">'SalePrice'</span>,data =data)</span><br><span class="line">fig.axis(ylim=<span class="number">0</span>,ymax=<span class="number">800000</span>)</span><br><span class="line">plt.xticks(rotation=<span class="number">90</span>)</span><br></pre></td></tr></table></figure>
<pre><code>(array([  0,   1,   2,   3,   4,   5,   6,   7,   8,   9,  10,  11,  12,
         13,  14,  15,  16,  17,  18,  19,  20,  21,  22,  23,  24,  25,
         26,  27,  28,  29,  30,  31,  32,  33,  34,  35,  36,  37,  38,
         39,  40,  41,  42,  43,  44,  45,  46,  47,  48,  49,  50,  51,
         52,  53,  54,  55,  56,  57,  58,  59,  60,  61,  62,  63,  64,
         65,  66,  67,  68,  69,  70,  71,  72,  73,  74,  75,  76,  77,
         78,  79,  80,  81,  82,  83,  84,  85,  86,  87,  88,  89,  90,
         91,  92,  93,  94,  95,  96,  97,  98,  99, 100, 101, 102, 103,
        104, 105, 106, 107, 108, 109, 110, 111]),
 &lt;a list of 112 Text xticklabel objects&gt;)
</code></pre><p><img src="/images/output_14_1.png" alt="png"></p>
<p>我们不知道’SalePrice’是否价格不变。 不变的价格试图消除通胀的影响。 如果’SalePrice’不是价格不变的话，它应该是，因此多年来价格可以比较</p>
<p>总结</p>
<ul>
<li>“GrLivArea”和“TotalBsmtSF”似乎与“SalePrice”线性相关。两种关系都是正的，这意味着随着一个变量的增加，另一个变量也会增加。在TotalBsmtSF的例子中，我们可以看到线性关系的斜率特别高。</li>
<li>“OverallQual”和“YearBuilt”似乎也与“SalePrice”有关。在“总体质量”的例子中，这种关系似乎更强，盒子图显示了销售价格如何随着整体质量的提高而上升。</li>
</ul>
<p>我们只分析了四个变量，但还有许多其他的变量需要分析。这里的技巧似乎是选择正确的特性(特性选择)，而不是定义它们之间的复杂关系(特性工程)。</p>
<h1 id="3"><a href="#3" class="headerlink" title="3"></a>3</h1><p>前面从主观上只是对认为重要的变量进行测量，<br>尽管分析是客观的，但是出发点是主观的。</p>
<p>要探究数据，从一直实用的方法开始</p>
<ul>
<li>Correlation matrix (heatmap style).关系矩阵/热力图</li>
<li>‘SalePrice’ correlation matrix (zoomed heatmap style).</li>
<li>Scatter plots between the most correlated variables (move like Jagger style). </li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#关系矩阵</span></span><br><span class="line">corrmat = df_train.corr()</span><br><span class="line"><span class="comment">#print(corrmat)</span></span><br><span class="line">f,ax = plt.subplots(figsize=(<span class="number">12</span>,<span class="number">9</span>))</span><br><span class="line">sns.heatmap(corrmat,vmax=<span class="number">0.8</span>,square = <span class="keyword">True</span>)</span><br></pre></td></tr></table></figure>
<pre><code>&lt;matplotlib.axes._subplots.AxesSubplot at 0x1f14d057518&gt;
</code></pre><p><img src="/images/output_19_1.png" alt="png"></p>
<p>热力图适合看大量变量之间的关系<br>可以一眼看出下面的变量关系强烈，共线性的情况，</p>
<ul>
<li>The first one refers to the ‘TotalBsmtSF’ and ‘1stFlrSF’ variables, </li>
<li>and the second one refers to the ‘GarageX’ variables</li>
</ul>
<p>热图非常适合检测这种情况，在像我们这样以特征选择为主的问题中，热图是必不可少的工具</p>
<p>再看’SalePrice’这一变量，’GrLivArea’ ‘TotalBsmtSF’, 和 ‘OverallQual’ 都有显著的相关性<br>但是也看到了其他变量也需要考虑进来。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#“SalePrice”相关矩阵(缩放热图样式</span></span><br><span class="line">k = <span class="number">10</span></span><br><span class="line">cols = corrmat.nlargest(k,<span class="string">'SalePrice'</span>).index</span><br><span class="line"><span class="comment">#print(cols)</span></span><br><span class="line">cm = np.corrcoef(df_train[cols].values.T)</span><br><span class="line">sns.set(font_scale=<span class="number">1.25</span>)</span><br><span class="line">hm = sns.heatmap(cm,cbar=<span class="keyword">True</span>,annot=<span class="keyword">True</span>,square=<span class="keyword">True</span>,fmt=<span class="string">'.2f'</span>,annot_kws=&#123;<span class="string">'size'</span>:<span class="number">10</span>&#125;,yticklabels=cols.values,xticklabels=cols.values)</span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure>
<p><img src="/images/output_22_0.png" alt="png"></p>
<p>从相关系数看出，几个变量与SalePrice非常相关：</p>
<ul>
<li>‘OverallQual’, ‘GrLivArea’ ‘TotalBsmtSF’ 已探索</li>
<li>GarageCars’ and ‘GarageArea’相关系数也大，但是二者之间有联系，只保留一个，保留大的那个，’GarageCars‘</li>
<li>“FullBath”？ 真的假的？</li>
<li>‘TotalBsmtSF’ and ‘1stFloor’ 也是只保留前者</li>
<li>‘TotRmsAbvGrd’ and ‘GrLivArea’,也是保留后者</li>
<li>“YearBuilt”似乎与“SalePrice”略有关联</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#“SalePrice”和相关变量之间的散点图(像Jagger风格一样移动)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#散点图</span></span><br><span class="line">sns.set()</span><br><span class="line">cols = [<span class="string">'SalePrice'</span>,<span class="string">'OverallQual'</span>,<span class="string">'GrLivArea'</span>,<span class="string">'GarageCars'</span>,<span class="string">'TotalBsmtSF'</span>,<span class="string">'FullBath'</span>,<span class="string">'YearBuilt'</span>]</span><br><span class="line">sns.pairplot(df_train[cols],height=<span class="number">2.5</span>)    <span class="comment">#成对关系</span></span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure>
<p><img src="/images/output_24_0.png" alt="png"></p>
<p>虽然我们已经知道了一些主要的数字，但是这个大型散点图让我们对变量关系有了一个合理的概念.</p>
<ul>
<li>‘TotalBsmtSF’ 和’GrLiveArea’之间似乎有一条直线，像个界限，大部分的点位于线以下。这是很合理的：地下室面积可以等于地上的生活区，但地下室面积不能大于地上的生活区(除非你想买地堡)。</li>
<li>‘SalePrice’ and ‘YearBuilt’之间：在“点云”的底部，我们看到的几乎是一个害羞的指数函数(要有创造力)。我们还可以在“点云”的上界看到同样的趋势(更具创造性)。同时，注意过去几年的点集是如何保持在这个极限之上的(我只是想说，现在的价格增长更快)。</li>
</ul>
<h1 id="4-缺失数据"><a href="#4-缺失数据" class="headerlink" title="4. 缺失数据"></a>4. 缺失数据</h1><p>重要的问题：</p>
<ul>
<li>缺失的数据有多普遍?</li>
<li>丢失的数据是随机的还是有规律的？</li>
</ul>
<p>出于实际原因，这些问题的答案很重要，因为缺少数据可能意味着样本量的减少。 这可以阻止我们继续进行分析。 此外，从实质的角度来看，我们需要确保缺失的数据流程没有偏见并隐藏一个不方便的事实。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#观察缺失数据</span></span><br><span class="line">total = df_train.isnull().sum().sort_values(ascending=<span class="keyword">False</span>)        <span class="comment">#每个变量缺失数量</span></span><br><span class="line"><span class="comment">#print(total)</span></span><br><span class="line">percent = (df_train.isnull().sum()/df_train.isnull().count()).sort_values(ascending=<span class="keyword">False</span>)  <span class="comment">#每个变量缺失比例</span></span><br><span class="line">missing_data = pd.concat([total,percent],axis = <span class="number">1</span>,keys=[<span class="string">'Total'</span>,<span class="string">'Percent'</span>])</span><br><span class="line">missing_data.head(<span class="number">20</span>)</span><br></pre></td></tr></table></figure>
<p><div></div></p>
<p><style scoped><br>    .dataframe tbody tr th:only-of-type {<br>        vertical-align: middle;<br>    }</p>
<pre><code>.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead th {
    text-align: right;
}
</code></pre><table border="1" class="dataframe"><br>  <thead><br>    <tr style="text-align: right;"><br>      <th></th><br>      <th>Total</th><br>      <th>Percent</th><br>    </tr><br>  </thead><br>  <tbody><br>    <tr><br>      <th>PoolQC</th><br>      <td>1453</td><br>      <td>0.995205</td><br>    </tr><br>    <tr><br>      <th>MiscFeature</th><br>      <td>1406</td><br>      <td>0.963014</td><br>    </tr><br>    <tr><br>      <th>Alley</th><br>      <td>1369</td><br>      <td>0.937671</td><br>    </tr><br>    <tr><br>      <th>Fence</th><br>      <td>1179</td><br>      <td>0.807534</td><br>    </tr><br>    <tr><br>      <th>FireplaceQu</th><br>      <td>690</td><br>      <td>0.472603</td><br>    </tr><br>    <tr><br>      <th>LotFrontage</th><br>      <td>259</td><br>      <td>0.177397</td><br>    </tr><br>    <tr><br>      <th>GarageCond</th><br>      <td>81</td><br>      <td>0.055479</td><br>    </tr><br>    <tr><br>      <th>GarageType</th><br>      <td>81</td><br>      <td>0.055479</td><br>    </tr><br>    <tr><br>      <th>GarageYrBlt</th><br>      <td>81</td><br>      <td>0.055479</td><br>    </tr><br>    <tr><br>      <th>GarageFinish</th><br>      <td>81</td><br>      <td>0.055479</td><br>    </tr><br>    <tr><br>      <th>GarageQual</th><br>      <td>81</td><br>      <td>0.055479</td><br>    </tr><br>    <tr><br>      <th>BsmtExposure</th><br>      <td>38</td><br>      <td>0.026027</td><br>    </tr><br>    <tr><br>      <th>BsmtFinType2</th><br>      <td>38</td><br>      <td>0.026027</td><br>    </tr><br>    <tr><br>      <th>BsmtFinType1</th><br>      <td>37</td><br>      <td>0.025342</td><br>    </tr><br>    <tr><br>      <th>BsmtCond</th><br>      <td>37</td><br>      <td>0.025342</td><br>    </tr><br>    <tr><br>      <th>BsmtQual</th><br>      <td>37</td><br>      <td>0.025342</td><br>    </tr><br>    <tr><br>      <th>MasVnrArea</th><br>      <td>8</td><br>      <td>0.005479</td><br>    </tr><br>    <tr><br>      <th>MasVnrType</th><br>      <td>8</td><br>      <td>0.005479</td><br>    </tr><br>    <tr><br>      <th>Electrical</th><br>      <td>1</td><br>      <td>0.000685</td><br>    </tr><br>    <tr><br>      <th>Utilities</th><br>      <td>0</td><br>      <td>0.000000</td><br>    </tr><br>  </tbody><br></table>


<p>如何处理</p>
<ul>
<li><p>我们会考虑当超过15％的数据丢失时，我们应该删除相应的变量并假装它从未存在过。 这意味着在这些情况下我们不会尝试任何技巧来填充缺失的数据。 据此，我们应该删除一组变量（例如’PoolQC’，’MiscFeature’，’Alley’等）。 关键是：我们会错过这些数据吗？ 我不这么认为。 这些变量似乎都不是非常重要，因为它们中的大部分都不是我们在买房时考虑的方面（也许这就是为什么数据丢失的原因？）。 此外，仔细观察变量，我们可以说像’PoolQC’，’MiscFeature’和’FireplaceQu’这样的变量是异常值的强有力候选者，所以我们很乐意删除它们</p>
</li>
<li><p>在剩下的情况下，我们可以看到’GarageX’变量具有相同数量的缺失数据。 我打赌缺失的数据是指同一组观察结果（虽然我不会检查它;它只是5％，我们不应该花费20 in5in5问题）。 由于关于车库的最重要的信息是由’GarageCars’表示的，并且考虑到我们只讨论了5％的缺失数据，我将删除提到的’GarageX’变量。 同样的逻辑适用于’BsmtX’变量。</p>
</li>
<li><p>关于’MasVnrArea’和’MasVnrType’，我们可以认为这些变量不是必需的。 此外，它们与已经考虑过的’YearBuilt’和’OverallQual’有很强的相关性。 因此，如果我们删’MasVnrArea’和’MasVnrType’，我们不会丢失信息。</p>
</li>
<li><p>最后，我们在’Electrical’中有一个缺失的观察结果。 由于它只是一个观察，我们将删除此观察并保留变量。</p>
</li>
<li><p>总之，为了处理丢失的数据，我们将删除所有缺少数据的变量，但变量“Electrical”除外。 在“电气”中，我们将删除缺少数据的观察结果。</p>
</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#处理缺失数据</span></span><br><span class="line">df_train = df_train.drop((missing_data[missing_data[<span class="string">'Total'</span>]&gt;<span class="number">1</span>]).index, axis= <span class="number">1</span>)</span><br><span class="line">df_train = df_train.drop(df_train.loc[df_train[<span class="string">'Electrical'</span>].isnull()].index)</span><br><span class="line">df_train.isnull().sum().max() <span class="comment">#检查是否还有缺失数据</span></span><br></pre></td></tr></table></figure>
<figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">0</span><br></pre></td></tr></table></figure>
<h1 id="异常值"><a href="#异常值" class="headerlink" title="异常值"></a>异常值</h1><p> 异常值也是我们应该注意的事情。 为什么？ 因为异常值可以显着影响我们的模型，并且可以成为有价值的信息来源，为我们提供有关特定行为的见解。</p>
<p>异常值是一个复杂的主题，值得更多关注。 在这里，我们将通过“SalePrice”的标准偏差和一组散点图进行快速分析。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#标准化数据</span></span><br><span class="line">saleprice_scaled = StandardScaler().fit_transform(df_train[<span class="string">'SalePrice'</span>][:,np.newaxis])</span><br><span class="line">low_range = saleprice_scaled[saleprice_scaled[:,<span class="number">0</span>].argsort()][:<span class="number">10</span>] <span class="comment">#argsort函数返回的是数组值从小到大的索引值</span></span><br><span class="line">high_range = saleprice_scaled[saleprice_scaled[:,<span class="number">0</span>].argsort()][<span class="number">-10</span>:]</span><br><span class="line">print(<span class="string">'分布（低）的外部范围：'</span>)</span><br><span class="line">print(low_range)</span><br><span class="line">print(<span class="string">'\n分布（高）的外部范围:'</span>)</span><br><span class="line">print(high_range)</span><br></pre></td></tr></table></figure>
<pre><code>分布（低）的外部范围：
[[-1.83820775]
 [-1.83303414]
 [-1.80044422]
 [-1.78282123]
 [-1.77400974]
 [-1.62295562]
 [-1.6166617 ]
 [-1.58519209]
 [-1.58519209]
 [-1.57269236]]

分布（高）的外部范围:
[[3.82758058]
 [4.0395221 ]
 [4.49473628]
 [4.70872962]
 [4.728631  ]
 [5.06034585]
 [5.42191907]
 [5.58987866]
 [7.10041987]
 [7.22629831]]


C:\Users\35038\Anaconda3\lib\site-packages\sklearn\utils\validation.py:475: DataConversionWarning: Data with input dtype int64 was converted to float64 by StandardScaler.
  warnings.warn(msg, DataConversionWarning)
C:\Users\35038\Anaconda3\lib\site-packages\sklearn\utils\validation.py:475: DataConversionWarning: Data with input dtype int64 was converted to float64 by StandardScaler.
  warnings.warn(msg, DataConversionWarning)
</code></pre><ul>
<li>低量程值相似，且离0不远。</li>
<li>高量程值远离0。7点几的话，确实超出了范围。</li>
</ul>
<p>现在，我们不考虑这些值中的任何一个作为离群值，但是我们应该小心这两个7。值的东西</p>
<h1 id="二变量分析-异常值"><a href="#二变量分析-异常值" class="headerlink" title="二变量分析 异常值"></a>二变量分析 异常值</h1><p>下面的散点图我们已经背熟了。然而，当我们从一个新的角度看待事物时，总会发现一些东西。正如艾伦•凯(Alan Kay)所说，“观点的改变抵得上智商的80分。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#saleprice 和grlivarea的关系</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#GrLivArea 和 SalePrice的散点图</span></span><br><span class="line">var = <span class="string">'GrLivArea'</span></span><br><span class="line">data = pd.concat([df_train[<span class="string">'SalePrice'</span>],df_train[var]],axis = <span class="number">1</span>)</span><br><span class="line">data.plot.scatter(x=var,y=<span class="string">'SalePrice'</span>,ylim=(<span class="number">0</span>,<span class="number">800000</span>))</span><br></pre></td></tr></table></figure>
<pre><code>&lt;matplotlib.axes._subplots.AxesSubplot at 0x1f14c1c74a8&gt;
</code></pre><p><img src="/images/output_34_1.png" alt="png"></p>
<ul>
<li>“GrLivArea”更大的两个值看起来很奇怪，它们并没有随大流。我们可以推测为什么会这样。也许他们指的是农业地区，这可以解释为什么价格这么低。我不确定这一点，但我很有信心，这两点并不能代表典型的案例。因此，我们将它们定义为离群值并删除它们。</li>
<li>图顶端的两个观察结果正是7.的值。我们说过要注意观察到的一些现象。它们看起来像两个特殊的案例，但它们似乎正在遵循这一趋势。因为那个原因，我们会保留它们。</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#删除异常值</span></span><br><span class="line">df_train.sort_values(by = <span class="string">'GrLivArea'</span>,ascending=<span class="keyword">False</span>)[:<span class="number">2</span>]</span><br><span class="line">df_train = df_train.drop(df_train[df_train[<span class="string">'Id'</span>] == <span class="number">1299</span>].index)</span><br><span class="line">df_train = df_train.drop(df_train[df_train[<span class="string">'Id'</span>] == <span class="number">524</span>].index)</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#TotalBsmtSF 和SalePrice的散点图</span></span><br><span class="line">var = <span class="string">'TotalBsmtSF'</span></span><br><span class="line">data = pd.concat([df_train[<span class="string">'SalePrice'</span>],df_train[var]],axis =<span class="number">1</span>)</span><br><span class="line">data.plot.scatter(x=var,y=<span class="string">'SalePrice'</span>,ylim=(<span class="number">0</span>,<span class="number">800000</span>))</span><br></pre></td></tr></table></figure>
<pre><code>&lt;matplotlib.axes._subplots.AxesSubplot at 0x1f1521c4f98&gt;
</code></pre><p><img src="/images/output_37_1.png" alt="png"></p>
<p>我们可能想要删除一些观察结果(例如TotalBsmtSF &gt; 3000)，但我认为这不值得。我们可以忍受，所以我们什么也不做。</p>
<h1 id="关键核心"><a href="#关键核心" class="headerlink" title="关键核心"></a>关键核心</h1><p>检验多元分析的统计基础的假设。我们已经做了一些数据清理，发现了很多关于“SalePrice”的信息。现在是时候深入了解“SalePrice”是如何符合那些使我们能够应用多元技术的统计假设的了。</p>
<ul>
<li>正态性-当我们讨论正态性时我们的意思是数据应该看起来像正态分布。这很重要，因为一些统计测试依赖于此(例如t统计)。在这个练习中，我们将检查“SalePrice”的单变量正态性(这是一种有限的方法)。记住，单变量正态性并不能保证多变量正态性(这正是我们想要的)，但它是有帮助的。另一个需要考虑的细节是，在大样本中(&gt;200次观察)，正态性不是大的问题。然而，如果我们解决了常态，我们就可以避免很多其他问题(比如：异方差性）</li>
<li>同方差-。同方差性是指“假设因变量(s)在预测变量(s)的范围内表现出相同程度的方差”(Hair et al.， 2013)。同方差是可取的，因为我们希望所有自变量的误差项都是相同的。</li>
<li>线性度-评估线性度最常用的方法是检查散点图和搜索线性模式。如果模式不是线性的，则有必要研究数据转换。但是，我们不会深入讨论这个问题，因为我们所看到的散点图似乎都有线性关系。</li>
<li>误差无相关性——自相关，就像定义的，发生在一个误差与另一个误差相关的时候。例如，如果一个误差系统地产生一个负误差，这意味着这些变量之间存在关系。这通常发生在时间序列中，其中一些模式与时间有关。我们也不会深入讨论这个问题。但是，如果您检测到什么，请尝试添加一个变量来解释您所得到的效果。这是相关误差最常见的解决方案。</li>
</ul>
<h1 id="正态检验"><a href="#正态检验" class="headerlink" title="正态检验"></a>正态检验</h1><p>这里的重点是用一种非常精简的方式测试“SalePrice”。我们要注意的是</p>
<ul>
<li>直方图，峰度和偏度。</li>
<li>正态概率图 数据分布应紧跟表示正态分布的对角线。</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#直方图 和 正态概率图</span></span><br><span class="line">sns.distplot(df_train[<span class="string">'SalePrice'</span>],fit=norm)</span><br><span class="line">fig = plt.figure()</span><br><span class="line">res = stats.probplot(df_train[<span class="string">'SalePrice'</span>],plot=plt)</span><br></pre></td></tr></table></figure>
<pre><code>C:\Users\35038\Anaconda3\lib\site-packages\scipy\stats\stats.py:1713: FutureWarning: Using a non-tuple sequence for multidimensional indexing is deprecated; use `arr[tuple(seq)]` instead of `arr[seq]`. In the future this will be interpreted as an array index, `arr[np.array(seq)]`, which will result either in an error or a different result.
  return np.add.reduce(sorted[indexer] * weights, axis=axis) / sumval
</code></pre><p><img src="/images/output_41_1.png" alt="png"></p>
<p><img src="/images/output_41_2.png" alt="png"></p>
<p>‘SalePrice’不正态。 它显示“峰值”，正偏斜并且不跟随对角线。</p>
<p>但一切都没有丢失。 简单的数据转换可以解决问题。<br>这是你可以在统计书中学到的很棒的东西之一：如果是正偏斜，对数转换通常很有效。  </p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#采取对数转换</span></span><br><span class="line">df_train[<span class="string">'SalePrice'</span>] = np.log(df_train[<span class="string">'SalePrice'</span>])</span><br><span class="line"><span class="comment">#再次画图</span></span><br><span class="line"><span class="comment">#直方图 和 正态概率图</span></span><br><span class="line">sns.distplot(df_train[<span class="string">'SalePrice'</span>],fit=norm)</span><br><span class="line">fig = plt.figure()</span><br><span class="line">res = stats.probplot(df_train[<span class="string">'SalePrice'</span>],plot=plt)</span><br></pre></td></tr></table></figure>
<pre><code>C:\Users\35038\Anaconda3\lib\site-packages\scipy\stats\stats.py:1713: FutureWarning: Using a non-tuple sequence for multidimensional indexing is deprecated; use `arr[tuple(seq)]` instead of `arr[seq]`. In the future this will be interpreted as an array index, `arr[np.array(seq)]`, which will result either in an error or a different result.
  return np.add.reduce(sorted[indexer] * weights, axis=axis) / sumval
</code></pre><p><img src="/images/output_43_1.png" alt="png"></p>
<p><img src="/images/output_43_2.png" alt="png"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#对’GrLivArea‘的检验</span></span><br><span class="line">sns.distplot(df_train[<span class="string">'GrLivArea'</span>],fit=norm)</span><br><span class="line">fig = plt.figure()</span><br><span class="line">res = stats.probplot(df_train[<span class="string">'GrLivArea'</span>],plot=plt)</span><br></pre></td></tr></table></figure>
<pre><code>C:\Users\35038\Anaconda3\lib\site-packages\scipy\stats\stats.py:1713: FutureWarning: Using a non-tuple sequence for multidimensional indexing is deprecated; use `arr[tuple(seq)]` instead of `arr[seq]`. In the future this will be interpreted as an array index, `arr[np.array(seq)]`, which will result either in an error or a different result.
  return np.add.reduce(sorted[indexer] * weights, axis=axis) / sumval
</code></pre><p><img src="/images/output_44_1.png" alt="png"></p>
<p><img src="/images/output_44_2.png" alt="png"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#同样数据转换 再画图</span></span><br><span class="line">df_train[<span class="string">'GrLivArea'</span>] = np.log(df_train[<span class="string">'GrLivArea'</span>])</span><br><span class="line">sns.distplot(df_train[<span class="string">'GrLivArea'</span>],fit=norm)</span><br><span class="line">fig = plt.figure()</span><br><span class="line">res = stats.probplot(df_train[<span class="string">'GrLivArea'</span>],plot=plt)</span><br></pre></td></tr></table></figure>
<pre><code>C:\Users\35038\Anaconda3\lib\site-packages\scipy\stats\stats.py:1713: FutureWarning: Using a non-tuple sequence for multidimensional indexing is deprecated; use `arr[tuple(seq)]` instead of `arr[seq]`. In the future this will be interpreted as an array index, `arr[np.array(seq)]`, which will result either in an error or a different result.
  return np.add.reduce(sorted[indexer] * weights, axis=axis) / sumval
</code></pre><p><img src="/images/output_45_1.png" alt="png"></p>
<p><img src="/images/output_45_2.png" alt="png"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#对‘TotalBsmtSF'检验</span></span><br><span class="line">sns.distplot(df_train[<span class="string">'TotalBsmtSF'</span>],fit=norm)</span><br><span class="line">fig = plt.figure()</span><br><span class="line">res = stats.probplot(df_train[<span class="string">'TotalBsmtSF'</span>],plot=plt)</span><br></pre></td></tr></table></figure>
<pre><code>C:\Users\35038\Anaconda3\lib\site-packages\scipy\stats\stats.py:1713: FutureWarning: Using a non-tuple sequence for multidimensional indexing is deprecated; use `arr[tuple(seq)]` instead of `arr[seq]`. In the future this will be interpreted as an array index, `arr[np.array(seq)]`, which will result either in an error or a different result.
  return np.add.reduce(sorted[indexer] * weights, axis=axis) / sumval
</code></pre><p><img src="/images/output_46_1.png" alt="png"></p>
<p><img src="/images/output_46_2.png" alt="png"></p>
<ul>
<li>总的来说，呈现偏态的东西。</li>
<li>大量观测值为零(没有地下室的房屋)。</li>
<li>这是个大问题，因为0值不允许我们做对数变换。<br>要在此处应用对数转换，我们将创建一个可以获得具有或不具有基础（二进制变量）的效果的变量。 然后，我们将对所有非零观测值进行对数变换，忽略值为零的观测值。 这样我们就可以转换数据，而不会失去有或没有地下室的影响。</li>
</ul>
<p>我不确定这种方法是否正确。 这对我来说似乎是对的。 这就是我所谓的“高风险工程”</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#创建一个新变量</span></span><br><span class="line"><span class="comment">#area&gt;0 则为1，area==0，则为0</span></span><br><span class="line">df_train[<span class="string">'HasBsmt'</span>] = pd.Series(len(df_train[<span class="string">'TotalBsmtSF'</span>]),index=df_train.index)</span><br><span class="line">df_train[<span class="string">'HasBsmt'</span>] = <span class="number">0</span></span><br><span class="line">df_train.loc[df_train[<span class="string">'TotalBsmtSF'</span>]&gt;<span class="number">0</span> ,<span class="string">'HasBsmt'</span>]=<span class="number">1</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#再转换数据 画图</span></span><br><span class="line">df_train.loc[df_train[<span class="string">'HasBsmt'</span>] ==<span class="number">1</span>,<span class="string">'TotalBsmtSF'</span>] = np.log(df_train[<span class="string">'TotalBsmtSF'</span>])</span><br><span class="line">sns.distplot(df_train[df_train[<span class="string">'TotalBsmtSF'</span>] &gt;<span class="number">0</span>][<span class="string">'TotalBsmtSF'</span>] ,fit=norm)   <span class="comment">#只画大于0的那些数据</span></span><br><span class="line">fig = plt.figure()</span><br><span class="line">res = stats.probplot(df_train[df_train[<span class="string">'TotalBsmtSF'</span>] &gt;<span class="number">0</span>][<span class="string">'TotalBsmtSF'</span>],plot=plt)</span><br></pre></td></tr></table></figure>
<pre><code>C:\Users\35038\Anaconda3\lib\site-packages\ipykernel_launcher.py:8: RuntimeWarning: divide by zero encountered in log

C:\Users\35038\Anaconda3\lib\site-packages\scipy\stats\stats.py:1713: FutureWarning: Using a non-tuple sequence for multidimensional indexing is deprecated; use `arr[tuple(seq)]` instead of `arr[seq]`. In the future this will be interpreted as an array index, `arr[np.array(seq)]`, which will result either in an error or a different result.
  return np.add.reduce(sorted[indexer] * weights, axis=axis) / sumval
</code></pre><p><img src="/images/output_48_1.png" alt="png"></p>
<p><img src="/images/output_48_2.png" alt="png"></p>
<h1 id="同方差检验"><a href="#同方差检验" class="headerlink" title="同方差检验"></a>同方差检验</h1><p>测试两个度量变量的同方差的最佳方法是用图形表示。偏离相同色散的形状有圆锥(图的一边小色散，另一边大色散)或菱形(分布中心的大量点)。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">plt.scatter(df_train[<span class="string">'GrLivArea'</span>],df_train[<span class="string">'SalePrice'</span>])</span><br></pre></td></tr></table></figure>
<pre><code>&lt;matplotlib.collections.PathCollection at 0x1f152622c50&gt;
</code></pre><p><img src="/images/output_50_1.png" alt="png"></p>
<p>此散点图的旧版本（在对数转换之前）具有圆锥形状（返回并检查’SalePrice’和相关变量之间的散点图（像Jagger样式一样移动）’）。<br>如您所见，当前的散点图不再具有圆锥形状。 这是正态化的力量！ 只是通过确保某些变量的正常性，我们解决了同方差性问题</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">plt.scatter(df_train[df_train[<span class="string">'TotalBsmtSF'</span>]&gt;<span class="number">0</span>][<span class="string">'TotalBsmtSF'</span>],df_train[df_train[<span class="string">'TotalBsmtSF'</span>]&gt;<span class="number">0</span>][<span class="string">'SalePrice'</span>])</span><br><span class="line"><span class="comment">#保证同数据</span></span><br></pre></td></tr></table></figure>
<pre><code>&lt;matplotlib.collections.PathCollection at 0x1f14c7f1f98&gt;
</code></pre><p><img src="/images/output_52_1.png" alt="png"></p>
<p>可以看到SalePrice’在’TotalBsmtSF ‘范围内显示出相同水平的差异</p>
<h1 id="虚拟变量"><a href="#虚拟变量" class="headerlink" title="虚拟变量"></a>虚拟变量</h1><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#将类别变量转化为虚拟变量</span></span><br><span class="line">df_train = pd.get_dummies(df_train)</span><br></pre></td></tr></table></figure>
<p>我们单独分析了’SalePrice’并且使用最相关的变量，我们处理了缺失数据和异常值，我们测试了一些基本的统计假设，我们甚至将分类变量转换为虚拟变量。 这是Python帮助我们轻松完成的大量工作。</p>
</style></p></div><div class="tags"><a href="/tags/python/">python</a></div><div class="post-nav"><a class="pre" href="/2018/12/06/多学习 多准备 抓住机会/">多学习 多准备 抓住机会</a><a class="next" href="/2018/12/03/项目2.视频网站数据/">项目学习2.视频网站数据清洗整理</a></div></div></div></div><div class="pure-u-1-4 hidden_mid_and_down"><div id="sidebar"><div class="widget"><form class="search-form" action="//www.google.com/search" method="get" accept-charset="utf-8" target="_blank"><input type="text" name="q" maxlength="20" placeholder="Search"/><input type="hidden" name="sitesearch" value="https://dnotameni.github.io"/></form></div><div class="widget"><div class="widget-title"><i class="fa fa-folder-o"> 分类</i></div><ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/🐍python/">🐍python</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/🐍python/项目学习/">项目学习</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/🐥生活炸鸡/">🐥生活炸鸡</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/💻站点维护/">💻站点维护</a></li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-star-o"> 标签</i></div><div class="tagcloud"><a href="/tags/hexo/" style="font-size: 15px;">hexo</a> <a href="/tags/生活/" style="font-size: 15px;">生活</a> <a href="/tags/python/" style="font-size: 15px;">python</a></div></div><div class="widget"><div class="widget-title"><i class="fa fa-file-o"> 最近文章</i></div><ul class="post-list"><li class="post-list-item"><a class="post-list-link" href="/2019/02/16/hexo_使用技巧/">hexo_使用技巧</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/12/06/多学习 多准备 抓住机会/">多学习 多准备 抓住机会</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/12/05/项目3.comprehensive-data-exploration-with-python/">项目学习3.Kaggle利用python对数据的探索性理解</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/12/03/项目2.视频网站数据/">项目学习2.视频网站数据清洗整理</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/12/01/项目1.知乎数据清洗整理和结论研究/">项目学习1.知乎数据清洗整理和结论研究</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/11/30/自我反思/">自我反思</a></li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-external-link"> 链接</i></div><ul></ul><a href="http://www.example1.com/" title="Github" target="_blank">Github</a><ul></ul><a href="http://www.example2.com/" title="weibo" target="_blank">weibo</a><ul></ul><a href="http://www.example3.com/" title="douban" target="_blank">douban</a></div></div></div><div class="pure-u-1 pure-u-md-3-4"><div id="footer">Copyright © 2019 <a href="/." rel="nofollow">DnoBlog.</a> Powered by<a rel="nofollow" target="_blank" href="https://hexo.io"> Hexo.</a><a rel="nofollow" target="_blank" href="https://github.com/tufu9441/maupassant-hexo"> Theme</a> by<a rel="nofollow" target="_blank" href="https://github.com/pagecho"> Cho.</a></div></div></div><a class="show" id="rocket" href="#top"></a><script type="text/javascript" src="/js/totop.js?v=0.0.0" async></script><script type="text/javascript" src="//lib.baomitu.com/fancybox/3.5.2/jquery.fancybox.min.js" async></script><script type="text/javascript" src="/js/fancybox.js?v=0.0.0" async></script><link rel="stylesheet" type="text/css" href="//lib.baomitu.com/fancybox/3.5.2/jquery.fancybox.min.css"><script type="text/javascript" src="/js/codeblock-resizer.js?v=0.0.0"></script><script type="text/javascript" src="/js/smartresize.js?v=0.0.0"></script></div></body></html>