

<!DOCTYPE html>



  


<html class="theme-next pisces use-motion" lang="zh-Hans">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>
<meta name="theme-color" content="#222">









<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />
















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />







<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.4" rel="stylesheet" type="text/css" />


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=5.1.4">


  <link rel="mask-icon" href="/images/logo.svg?v=5.1.4" color="#222">





  <meta name="keywords" content="Hexo, NexT" />










<meta name="description" content="好的量变引起质变">
<meta property="og:type" content="website">
<meta property="og:title" content="DnoBlog">
<meta property="og:url" content="http://yoursite.com/index.html">
<meta property="og:site_name" content="DnoBlog">
<meta property="og:description" content="好的量变引起质变">
<meta property="og:locale" content="zh-Hans">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="DnoBlog">
<meta name="twitter:description" content="好的量变引起质变">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Pisces',
    version: '5.1.4',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: '博主'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://yoursite.com/"/>





  <title>DnoBlog</title>
  








</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  
  
    
  

  <div class="container sidebar-position-left 
  page-home">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">DnoBlog</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle">学会思考</p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/about/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-user"></i> <br />
            
            关于
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            标签
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br />
            
            分类
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            归档
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/12/06/多学习 多准备 抓住机会/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="萨尔茨堡的树枝">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar1.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="DnoBlog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/12/06/多学习 多准备 抓住机会/" itemprop="url">多学习 多准备 抓住机会</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-12-06T14:13:00+08:00">
                2018-12-06
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/生活炸鸡🐥/" itemprop="url" rel="index">
                    <span itemprop="name">生活炸鸡🐥</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          
            <div class="post-wordcount">
              
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">字数统计&#58;</span>
                
                <span title="字数统计">
                  38
                </span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">阅读时长 &asymp;</span>
                
                <span title="阅读时长">
                  1
                </span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>近期目标：</p>
<ul>
<li>寻找实习 （与职规相符）</li>
<li>学习<ul>
<li>数据分析：python工具 | 统计分析知识 | 机器学习</li>
<li>风险模型：</li>
</ul>
</li>
<li>论文</li>
</ul>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/12/05/项目3.comprehensive-data-exploration-with-python/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="萨尔茨堡的树枝">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar1.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="DnoBlog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/12/05/项目3.comprehensive-data-exploration-with-python/" itemprop="url">项目学习3.Kaggle利用python对数据的探索性理解</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-12-05T13:52:00+08:00">
                2018-12-05
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/数据分析/" itemprop="url" rel="index">
                    <span itemprop="name">数据分析</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          
            <div class="post-wordcount">
              
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">字数统计&#58;</span>
                
                <span title="字数统计">
                  5,535
                </span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">阅读时长 &asymp;</span>
                
                <span title="阅读时长">
                  24
                </span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p><a href="https://www.kaggle.com/pmarcelino/comprehensive-data-exploration-with-python" target="_blank" rel="noopener">https://www.kaggle.com/pmarcelino/comprehensive-data-exploration-with-python</a></p>
<ol>
<li>Understand the problem#. We’ll look at each variable and do a philosophical analysis about their meaning and importance for this problem.<br>了解问题</li>
<li>Univariable study#. We’ll just focus on the dependent variable (‘SalePrice’) and try to know a little bit more about it.<br>单变量分析</li>
<li>Multivariate study#. We’ll try to understand how the dependent variable and independent variables relate.<br>多变量分析</li>
<li>Basic cleaning#. We’ll clean the dataset and handle the missing data, outliers and categorical variables.<br>基本清洗</li>
<li>Test assumptions#. We’ll check if our data meets the assumptions required by most multivariate techniques.<br>假设检验</li>
</ol>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#导入数据</span></span><br><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"><span class="keyword">import</span> seaborn <span class="keyword">as</span> sns</span><br><span class="line"><span class="keyword">from</span> scipy.stats <span class="keyword">import</span> norm</span><br><span class="line"><span class="keyword">from</span> sklearn.preprocessing <span class="keyword">import</span> StandardScaler</span><br><span class="line"><span class="keyword">from</span> scipy <span class="keyword">import</span> stats</span><br><span class="line">%matplotlib inline</span><br><span class="line"></span><br><span class="line">df_train = pd.read_csv(<span class="string">r'C:\C\Python\all\House Prices Advanced Regression Techniques\train.csv'</span>)</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#查看数据大致情况</span></span><br><span class="line">df_train.columns</span><br></pre></td></tr></table></figure>
<pre><code>Index([&apos;Id&apos;, &apos;MSSubClass&apos;, &apos;MSZoning&apos;, &apos;LotFrontage&apos;, &apos;LotArea&apos;, &apos;Street&apos;,
       &apos;Alley&apos;, &apos;LotShape&apos;, &apos;LandContour&apos;, &apos;Utilities&apos;, &apos;LotConfig&apos;,
       &apos;LandSlope&apos;, &apos;Neighborhood&apos;, &apos;Condition1&apos;, &apos;Condition2&apos;, &apos;BldgType&apos;,
       &apos;HouseStyle&apos;, &apos;OverallQual&apos;, &apos;OverallCond&apos;, &apos;YearBuilt&apos;, &apos;YearRemodAdd&apos;,
       &apos;RoofStyle&apos;, &apos;RoofMatl&apos;, &apos;Exterior1st&apos;, &apos;Exterior2nd&apos;, &apos;MasVnrType&apos;,
       &apos;MasVnrArea&apos;, &apos;ExterQual&apos;, &apos;ExterCond&apos;, &apos;Foundation&apos;, &apos;BsmtQual&apos;,
       &apos;BsmtCond&apos;, &apos;BsmtExposure&apos;, &apos;BsmtFinType1&apos;, &apos;BsmtFinSF1&apos;,
       &apos;BsmtFinType2&apos;, &apos;BsmtFinSF2&apos;, &apos;BsmtUnfSF&apos;, &apos;TotalBsmtSF&apos;, &apos;Heating&apos;,
       &apos;HeatingQC&apos;, &apos;CentralAir&apos;, &apos;Electrical&apos;, &apos;1stFlrSF&apos;, &apos;2ndFlrSF&apos;,
       &apos;LowQualFinSF&apos;, &apos;GrLivArea&apos;, &apos;BsmtFullBath&apos;, &apos;BsmtHalfBath&apos;, &apos;FullBath&apos;,
       &apos;HalfBath&apos;, &apos;BedroomAbvGr&apos;, &apos;KitchenAbvGr&apos;, &apos;KitchenQual&apos;,
       &apos;TotRmsAbvGrd&apos;, &apos;Functional&apos;, &apos;Fireplaces&apos;, &apos;FireplaceQu&apos;, &apos;GarageType&apos;,
       &apos;GarageYrBlt&apos;, &apos;GarageFinish&apos;, &apos;GarageCars&apos;, &apos;GarageArea&apos;, &apos;GarageQual&apos;,
       &apos;GarageCond&apos;, &apos;PavedDrive&apos;, &apos;WoodDeckSF&apos;, &apos;OpenPorchSF&apos;,
       &apos;EnclosedPorch&apos;, &apos;3SsnPorch&apos;, &apos;ScreenPorch&apos;, &apos;PoolArea&apos;, &apos;PoolQC&apos;,
       &apos;Fence&apos;, &apos;MiscFeature&apos;, &apos;MiscVal&apos;, &apos;MoSold&apos;, &apos;YrSold&apos;, &apos;SaleType&apos;,
       &apos;SaleCondition&apos;, &apos;SalePrice&apos;],
      dtype=&apos;object&apos;)
</code></pre><h1 id="1-我们希望得到什么？"><a href="#1-我们希望得到什么？" class="headerlink" title="1 我们希望得到什么？"></a>1 我们希望得到什么？</h1><p>为了了解数据，分析规则表：<br>1.变量- 变量名<br>2.类型- 变量类型：数值型 类别型<br>3.细分- 变量细分的识别。 我们可以定义三个可能的部分：建筑，空间或位置。 当我们说’建筑’时，我们指的是与建筑物的物理特征相关的变量（例如’OverallQual’）。 当我们说’空间’时，我们指的是一个报告房屋空间属性的变量（例如’TotalBsmtSF’）。 最后，当我们说“位置”时，我们指的是一个变量，它提供有关房屋所在位置的信息（例如“邻居”<br>4.期望- 我们对“销售价格”变量影响的期望。我们可以使用“高”、“中”和“低”作为可能值的分类量表<br>5.结论- 在我们快速查看数据之后，我们对变量重要性的结论。 我们可以保持与“期望”中相同的分类标度。<br>6.评论- 任何我们想到的一般性评论</p>
<p>为了填满这一栏，我们应该阅读所有变量的描述，然后一个接一个地问自己:<br>我们在买房的时候会考虑这个变量吗?例:当我们想到我们梦想中的房子时，我们会在意它的“砖石贴面类型”吗?<br>如果是，这个变量有多重要?例:拥有“优秀”材料而不是“差”材料对外观有什么影响?以及用“Excellent”而不是“Good”?<br>这个信息已经在其他变量中描述过了吗?例:如果“LandContour”给出了物业的平整度，我们真的需要知道“LandSlope”？）</p>
<p>目的：了解数据 找出哪几个变量重要</p>
<p>I went through this process and concluded that the following variables can play an important role in this problem:</p>
<ul>
<li>OverallQual (which is a variable that I don’t like because I don’t know how it was computed; a funny exercise would be to predict ‘OverallQual’ using all the other variables available).</li>
<li>YearBuilt.</li>
<li>TotalBsmtSF.</li>
<li>GrLivArea.</li>
</ul>
<h1 id="2-首先分析SalePrice变量，是我们的问题的目标。"><a href="#2-首先分析SalePrice变量，是我们的问题的目标。" class="headerlink" title="2 首先分析SalePrice变量，是我们的问题的目标。"></a>2 首先分析SalePrice变量，是我们的问题的目标。</h1><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">#统计描述</span></span><br><span class="line">df_train[<span class="string">'SalePrice'</span>].describe()</span><br><span class="line"></span><br><span class="line"><span class="comment">#直方图分布</span></span><br><span class="line">sns.distplot(df_train[<span class="string">'SalePrice'</span>]);</span><br></pre></td></tr></table></figure>
<pre><code>C:\Users\35038\Anaconda3\lib\site-packages\scipy\stats\stats.py:1713: FutureWarning: Using a non-tuple sequence for multidimensional indexing is deprecated; use `arr[tuple(seq)]` instead of `arr[seq]`. In the future this will be interpreted as an array index, `arr[np.array(seq)]`, which will result either in an error or a different result.
  return np.add.reduce(sorted[indexer] * weights, axis=axis) / sumval
</code></pre><p><img src="/images/output_6_1.png" alt="png"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">'''Deviate from the normal distribution.</span></span><br><span class="line"><span class="string">   Have appreciable positive skewness.右偏</span></span><br><span class="line"><span class="string">   Show peakedness.尖峰'''</span></span><br></pre></td></tr></table></figure>
<pre><code>&apos;Deviate from the normal distribution.\n   Have appreciable positive skewness.右偏\n   Show peakedness.尖峰&apos;
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#偏度和峰值</span></span><br><span class="line">print(<span class="string">'Skewness: %f'</span> % df_train[<span class="string">'SalePrice'</span>].skew())</span><br><span class="line">print(<span class="string">'Kurtosis: %f'</span> % df_train[<span class="string">'SalePrice'</span>].kurt())</span><br></pre></td></tr></table></figure>
<pre><code>Skewness: 1.882876
Kurtosis: 6.536282
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#与数值变量的关系</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#GrLivArea 和 SalePrice的散点图</span></span><br><span class="line">var = <span class="string">'GrLivArea'</span></span><br><span class="line">data = pd.concat([df_train[<span class="string">'SalePrice'</span>],df_train[var]],axis = <span class="number">1</span>)</span><br><span class="line">data.plot.scatter(x=var,y=<span class="string">'SalePrice'</span>,ylim=(<span class="number">0</span>,<span class="number">800000</span>))</span><br></pre></td></tr></table></figure>
<pre><code>&lt;matplotlib.axes._subplots.AxesSubplot at 0x1f14c5dc278&gt;
</code></pre><p><img src="/images/output_9_1.png" alt="png"></p>
<p>看起来二者有线性关系</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#TotalBsmtSF 和SalePrice的散点图</span></span><br><span class="line">var = <span class="string">'TotalBsmtSF'</span></span><br><span class="line">data = pd.concat([df_train[<span class="string">'SalePrice'</span>],df_train[var]],axis =<span class="number">1</span>)</span><br><span class="line">data.plot.scatter(x=var,y=<span class="string">'SalePrice'</span>,ylim=(<span class="number">0</span>,<span class="number">800000</span>))</span><br></pre></td></tr></table></figure>
<pre><code>&lt;matplotlib.axes._subplots.AxesSubplot at 0x1f14c68d390&gt;
</code></pre><p><img src="/images/output_11_1.png" alt="png"></p>
<p>看起来也有很强烈的线性关系 或者 指数关系；此外还有一些为0的值</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#与类别变量的关系</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#OverallQual和SalePrice的箱型图</span></span><br><span class="line">var= <span class="string">'OverallQual'</span></span><br><span class="line">data = pd.concat([df_train[<span class="string">'SalePrice'</span>],df_train[var]],axis=<span class="number">1</span>)</span><br><span class="line">f, ax = plt.subplots(figsize=(<span class="number">8</span>,<span class="number">6</span>))</span><br><span class="line">fig = sns.boxplot(x=var,y=<span class="string">'SalePrice'</span>,data=data)</span><br><span class="line">fig.axis(ymin=<span class="number">0</span>,ymax=<span class="number">800000</span>)</span><br></pre></td></tr></table></figure>
<pre><code>(-0.5, 9.5, 0, 800000)
</code></pre><p><img src="/images/output_13_1.png" alt="png"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">var = <span class="string">'YearBuilt'</span></span><br><span class="line">data = pd.concat([df_train[<span class="string">'SalePrice'</span>],df_train[var]],axis=<span class="number">1</span>)</span><br><span class="line">f,ax = plt.subplots(figsize=(<span class="number">16</span>,<span class="number">8</span>))</span><br><span class="line">fig = sns.boxplot(x=var,y= <span class="string">'SalePrice'</span>,data =data)</span><br><span class="line">fig.axis(ylim=<span class="number">0</span>,ymax=<span class="number">800000</span>)</span><br><span class="line">plt.xticks(rotation=<span class="number">90</span>)</span><br></pre></td></tr></table></figure>
<pre><code>(array([  0,   1,   2,   3,   4,   5,   6,   7,   8,   9,  10,  11,  12,
         13,  14,  15,  16,  17,  18,  19,  20,  21,  22,  23,  24,  25,
         26,  27,  28,  29,  30,  31,  32,  33,  34,  35,  36,  37,  38,
         39,  40,  41,  42,  43,  44,  45,  46,  47,  48,  49,  50,  51,
         52,  53,  54,  55,  56,  57,  58,  59,  60,  61,  62,  63,  64,
         65,  66,  67,  68,  69,  70,  71,  72,  73,  74,  75,  76,  77,
         78,  79,  80,  81,  82,  83,  84,  85,  86,  87,  88,  89,  90,
         91,  92,  93,  94,  95,  96,  97,  98,  99, 100, 101, 102, 103,
        104, 105, 106, 107, 108, 109, 110, 111]),
 &lt;a list of 112 Text xticklabel objects&gt;)
</code></pre><p><img src="/images/output_14_1.png" alt="png"></p>
<p>我们不知道’SalePrice’是否价格不变。 不变的价格试图消除通胀的影响。 如果’SalePrice’不是价格不变的话，它应该是，因此多年来价格可以比较</p>
<p>总结</p>
<ul>
<li>“GrLivArea”和“TotalBsmtSF”似乎与“SalePrice”线性相关。两种关系都是正的，这意味着随着一个变量的增加，另一个变量也会增加。在TotalBsmtSF的例子中，我们可以看到线性关系的斜率特别高。</li>
<li>“OverallQual”和“YearBuilt”似乎也与“SalePrice”有关。在“总体质量”的例子中，这种关系似乎更强，盒子图显示了销售价格如何随着整体质量的提高而上升。</li>
</ul>
<p>我们只分析了四个变量，但还有许多其他的变量需要分析。这里的技巧似乎是选择正确的特性(特性选择)，而不是定义它们之间的复杂关系(特性工程)。</p>
<h1 id="3"><a href="#3" class="headerlink" title="3"></a>3</h1><p>前面从主观上只是对认为重要的变量进行测量，<br>尽管分析是客观的，但是出发点是主观的。</p>
<p>要探究数据，从一直实用的方法开始</p>
<ul>
<li>Correlation matrix (heatmap style).关系矩阵/热力图</li>
<li>‘SalePrice’ correlation matrix (zoomed heatmap style).</li>
<li>Scatter plots between the most correlated variables (move like Jagger style). </li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#关系矩阵</span></span><br><span class="line">corrmat = df_train.corr()</span><br><span class="line"><span class="comment">#print(corrmat)</span></span><br><span class="line">f,ax = plt.subplots(figsize=(<span class="number">12</span>,<span class="number">9</span>))</span><br><span class="line">sns.heatmap(corrmat,vmax=<span class="number">0.8</span>,square = <span class="keyword">True</span>)</span><br></pre></td></tr></table></figure>
<pre><code>&lt;matplotlib.axes._subplots.AxesSubplot at 0x1f14d057518&gt;
</code></pre><p><img src="/images/output_19_1.png" alt="png"></p>
<p>热力图适合看大量变量之间的关系<br>可以一眼看出下面的变量关系强烈，共线性的情况，</p>
<ul>
<li>The first one refers to the ‘TotalBsmtSF’ and ‘1stFlrSF’ variables, </li>
<li>and the second one refers to the ‘GarageX’ variables</li>
</ul>
<p>热图非常适合检测这种情况，在像我们这样以特征选择为主的问题中，热图是必不可少的工具</p>
<p>再看’SalePrice’这一变量，’GrLivArea’ ‘TotalBsmtSF’, 和 ‘OverallQual’ 都有显著的相关性<br>但是也看到了其他变量也需要考虑进来。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#“SalePrice”相关矩阵(缩放热图样式</span></span><br><span class="line">k = <span class="number">10</span></span><br><span class="line">cols = corrmat.nlargest(k,<span class="string">'SalePrice'</span>).index</span><br><span class="line"><span class="comment">#print(cols)</span></span><br><span class="line">cm = np.corrcoef(df_train[cols].values.T)</span><br><span class="line">sns.set(font_scale=<span class="number">1.25</span>)</span><br><span class="line">hm = sns.heatmap(cm,cbar=<span class="keyword">True</span>,annot=<span class="keyword">True</span>,square=<span class="keyword">True</span>,fmt=<span class="string">'.2f'</span>,annot_kws=&#123;<span class="string">'size'</span>:<span class="number">10</span>&#125;,yticklabels=cols.values,xticklabels=cols.values)</span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure>
<p><img src="/images/output_22_0.png" alt="png"></p>
<p>从相关系数看出，几个变量与SalePrice非常相关：</p>
<ul>
<li>‘OverallQual’, ‘GrLivArea’ ‘TotalBsmtSF’ 已探索</li>
<li>GarageCars’ and ‘GarageArea’相关系数也大，但是二者之间有联系，只保留一个，保留大的那个，’GarageCars‘</li>
<li>“FullBath”？ 真的假的？</li>
<li>‘TotalBsmtSF’ and ‘1stFloor’ 也是只保留前者</li>
<li>‘TotRmsAbvGrd’ and ‘GrLivArea’,也是保留后者</li>
<li>“YearBuilt”似乎与“SalePrice”略有关联</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#“SalePrice”和相关变量之间的散点图(像Jagger风格一样移动)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#散点图</span></span><br><span class="line">sns.set()</span><br><span class="line">cols = [<span class="string">'SalePrice'</span>,<span class="string">'OverallQual'</span>,<span class="string">'GrLivArea'</span>,<span class="string">'GarageCars'</span>,<span class="string">'TotalBsmtSF'</span>,<span class="string">'FullBath'</span>,<span class="string">'YearBuilt'</span>]</span><br><span class="line">sns.pairplot(df_train[cols],height=<span class="number">2.5</span>)    <span class="comment">#成对关系</span></span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure>
<p><img src="/images/output_24_0.png" alt="png"></p>
<p>虽然我们已经知道了一些主要的数字，但是这个大型散点图让我们对变量关系有了一个合理的概念.</p>
<ul>
<li>‘TotalBsmtSF’ 和’GrLiveArea’之间似乎有一条直线，像个界限，大部分的点位于线以下。这是很合理的：地下室面积可以等于地上的生活区，但地下室面积不能大于地上的生活区(除非你想买地堡)。</li>
<li>‘SalePrice’ and ‘YearBuilt’之间：在“点云”的底部，我们看到的几乎是一个害羞的指数函数(要有创造力)。我们还可以在“点云”的上界看到同样的趋势(更具创造性)。同时，注意过去几年的点集是如何保持在这个极限之上的(我只是想说，现在的价格增长更快)。</li>
</ul>
<h1 id="4-缺失数据"><a href="#4-缺失数据" class="headerlink" title="4. 缺失数据"></a>4. 缺失数据</h1><p>重要的问题：</p>
<ul>
<li>缺失的数据有多普遍?</li>
<li>丢失的数据是随机的还是有规律的？</li>
</ul>
<p>出于实际原因，这些问题的答案很重要，因为缺少数据可能意味着样本量的减少。 这可以阻止我们继续进行分析。 此外，从实质的角度来看，我们需要确保缺失的数据流程没有偏见并隐藏一个不方便的事实。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#观察缺失数据</span></span><br><span class="line">total = df_train.isnull().sum().sort_values(ascending=<span class="keyword">False</span>)        <span class="comment">#每个变量缺失数量</span></span><br><span class="line"><span class="comment">#print(total)</span></span><br><span class="line">percent = (df_train.isnull().sum()/df_train.isnull().count()).sort_values(ascending=<span class="keyword">False</span>)  <span class="comment">#每个变量缺失比例</span></span><br><span class="line">missing_data = pd.concat([total,percent],axis = <span class="number">1</span>,keys=[<span class="string">'Total'</span>,<span class="string">'Percent'</span>])</span><br><span class="line">missing_data.head(<span class="number">20</span>)</span><br></pre></td></tr></table></figure>
<div><br><style scoped><br>    .dataframe tbody tr th:only-of-type {<br>        vertical-align: middle;<br>    }<br><br>    .dataframe tbody tr th {<br>        vertical-align: top;<br>    }<br><br>    .dataframe thead th {<br>        text-align: right;<br>    }<br></style><br><table border="1" class="dataframe"><br>  <thead><br>    <tr style="text-align: right;"><br>      <th></th><br>      <th>Total</th><br>      <th>Percent</th><br>    </tr><br>  </thead><br>  <tbody><br>    <tr><br>      <th>PoolQC</th><br>      <td>1453</td><br>      <td>0.995205</td><br>    </tr><br>    <tr><br>      <th>MiscFeature</th><br>      <td>1406</td><br>      <td>0.963014</td><br>    </tr><br>    <tr><br>      <th>Alley</th><br>      <td>1369</td><br>      <td>0.937671</td><br>    </tr><br>    <tr><br>      <th>Fence</th><br>      <td>1179</td><br>      <td>0.807534</td><br>    </tr><br>    <tr><br>      <th>FireplaceQu</th><br>      <td>690</td><br>      <td>0.472603</td><br>    </tr><br>    <tr><br>      <th>LotFrontage</th><br>      <td>259</td><br>      <td>0.177397</td><br>    </tr><br>    <tr><br>      <th>GarageCond</th><br>      <td>81</td><br>      <td>0.055479</td><br>    </tr><br>    <tr><br>      <th>GarageType</th><br>      <td>81</td><br>      <td>0.055479</td><br>    </tr><br>    <tr><br>      <th>GarageYrBlt</th><br>      <td>81</td><br>      <td>0.055479</td><br>    </tr><br>    <tr><br>      <th>GarageFinish</th><br>      <td>81</td><br>      <td>0.055479</td><br>    </tr><br>    <tr><br>      <th>GarageQual</th><br>      <td>81</td><br>      <td>0.055479</td><br>    </tr><br>    <tr><br>      <th>BsmtExposure</th><br>      <td>38</td><br>      <td>0.026027</td><br>    </tr><br>    <tr><br>      <th>BsmtFinType2</th><br>      <td>38</td><br>      <td>0.026027</td><br>    </tr><br>    <tr><br>      <th>BsmtFinType1</th><br>      <td>37</td><br>      <td>0.025342</td><br>    </tr><br>    <tr><br>      <th>BsmtCond</th><br>      <td>37</td><br>      <td>0.025342</td><br>    </tr><br>    <tr><br>      <th>BsmtQual</th><br>      <td>37</td><br>      <td>0.025342</td><br>    </tr><br>    <tr><br>      <th>MasVnrArea</th><br>      <td>8</td><br>      <td>0.005479</td><br>    </tr><br>    <tr><br>      <th>MasVnrType</th><br>      <td>8</td><br>      <td>0.005479</td><br>    </tr><br>    <tr><br>      <th>Electrical</th><br>      <td>1</td><br>      <td>0.000685</td><br>    </tr><br>    <tr><br>      <th>Utilities</th><br>      <td>0</td><br>      <td>0.000000</td><br>    </tr><br>  </tbody><br></table><br></div>



<p>如何处理</p>
<ul>
<li><p>我们会考虑当超过15％的数据丢失时，我们应该删除相应的变量并假装它从未存在过。 这意味着在这些情况下我们不会尝试任何技巧来填充缺失的数据。 据此，我们应该删除一组变量（例如’PoolQC’，’MiscFeature’，’Alley’等）。 关键是：我们会错过这些数据吗？ 我不这么认为。 这些变量似乎都不是非常重要，因为它们中的大部分都不是我们在买房时考虑的方面（也许这就是为什么数据丢失的原因？）。 此外，仔细观察变量，我们可以说像’PoolQC’，’MiscFeature’和’FireplaceQu’这样的变量是异常值的强有力候选者，所以我们很乐意删除它们</p>
</li>
<li><p>在剩下的情况下，我们可以看到’GarageX’变量具有相同数量的缺失数据。 我打赌缺失的数据是指同一组观察结果（虽然我不会检查它;它只是5％，我们不应该花费20 in5in5问题）。 由于关于车库的最重要的信息是由’GarageCars’表示的，并且考虑到我们只讨论了5％的缺失数据，我将删除提到的’GarageX’变量。 同样的逻辑适用于’BsmtX’变量。</p>
</li>
<li><p>关于’MasVnrArea’和’MasVnrType’，我们可以认为这些变量不是必需的。 此外，它们与已经考虑过的’YearBuilt’和’OverallQual’有很强的相关性。 因此，如果我们删’MasVnrArea’和’MasVnrType’，我们不会丢失信息。</p>
</li>
<li><p>最后，我们在’Electrical’中有一个缺失的观察结果。 由于它只是一个观察，我们将删除此观察并保留变量。</p>
</li>
<li><p>总之，为了处理丢失的数据，我们将删除所有缺少数据的变量，但变量“Electrical”除外。 在“电气”中，我们将删除缺少数据的观察结果。</p>
</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#处理缺失数据</span></span><br><span class="line">df_train = df_train.drop((missing_data[missing_data[<span class="string">'Total'</span>]&gt;<span class="number">1</span>]).index, axis= <span class="number">1</span>)</span><br><span class="line">df_train = df_train.drop(df_train.loc[df_train[<span class="string">'Electrical'</span>].isnull()].index)</span><br><span class="line">df_train.isnull().sum().max() <span class="comment">#检查是否还有缺失数据</span></span><br></pre></td></tr></table></figure>
<pre><code>0
</code></pre><h1 id="异常值"><a href="#异常值" class="headerlink" title="异常值"></a>异常值</h1><p> 异常值也是我们应该注意的事情。 为什么？ 因为异常值可以显着影响我们的模型，并且可以成为有价值的信息来源，为我们提供有关特定行为的见解。</p>
<p>异常值是一个复杂的主题，值得更多关注。 在这里，我们将通过“SalePrice”的标准偏差和一组散点图进行快速分析。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#标准化数据</span></span><br><span class="line">saleprice_scaled = StandardScaler().fit_transform(df_train[<span class="string">'SalePrice'</span>][:,np.newaxis])</span><br><span class="line">low_range = saleprice_scaled[saleprice_scaled[:,<span class="number">0</span>].argsort()][:<span class="number">10</span>] <span class="comment">#argsort函数返回的是数组值从小到大的索引值</span></span><br><span class="line">high_range = saleprice_scaled[saleprice_scaled[:,<span class="number">0</span>].argsort()][<span class="number">-10</span>:]</span><br><span class="line">print(<span class="string">'分布（低）的外部范围：'</span>)</span><br><span class="line">print(low_range)</span><br><span class="line">print(<span class="string">'\n分布（高）的外部范围:'</span>)</span><br><span class="line">print(high_range)</span><br></pre></td></tr></table></figure>
<pre><code>分布（低）的外部范围：
[[-1.83820775]
 [-1.83303414]
 [-1.80044422]
 [-1.78282123]
 [-1.77400974]
 [-1.62295562]
 [-1.6166617 ]
 [-1.58519209]
 [-1.58519209]
 [-1.57269236]]

分布（高）的外部范围:
[[3.82758058]
 [4.0395221 ]
 [4.49473628]
 [4.70872962]
 [4.728631  ]
 [5.06034585]
 [5.42191907]
 [5.58987866]
 [7.10041987]
 [7.22629831]]


C:\Users\35038\Anaconda3\lib\site-packages\sklearn\utils\validation.py:475: DataConversionWarning: Data with input dtype int64 was converted to float64 by StandardScaler.
  warnings.warn(msg, DataConversionWarning)
C:\Users\35038\Anaconda3\lib\site-packages\sklearn\utils\validation.py:475: DataConversionWarning: Data with input dtype int64 was converted to float64 by StandardScaler.
  warnings.warn(msg, DataConversionWarning)
</code></pre><ul>
<li>低量程值相似，且离0不远。</li>
<li>高量程值远离0。7点几的话，确实超出了范围。</li>
</ul>
<p>现在，我们不考虑这些值中的任何一个作为离群值，但是我们应该小心这两个7。值的东西</p>
<h1 id="二变量分析-异常值"><a href="#二变量分析-异常值" class="headerlink" title="二变量分析 异常值"></a>二变量分析 异常值</h1><p>下面的散点图我们已经背熟了。然而，当我们从一个新的角度看待事物时，总会发现一些东西。正如艾伦•凯(Alan Kay)所说，“观点的改变抵得上智商的80分。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#saleprice 和grlivarea的关系</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#GrLivArea 和 SalePrice的散点图</span></span><br><span class="line">var = <span class="string">'GrLivArea'</span></span><br><span class="line">data = pd.concat([df_train[<span class="string">'SalePrice'</span>],df_train[var]],axis = <span class="number">1</span>)</span><br><span class="line">data.plot.scatter(x=var,y=<span class="string">'SalePrice'</span>,ylim=(<span class="number">0</span>,<span class="number">800000</span>))</span><br></pre></td></tr></table></figure>
<pre><code>&lt;matplotlib.axes._subplots.AxesSubplot at 0x1f14c1c74a8&gt;
</code></pre><p><img src="/images/output_34_1.png" alt="png"></p>
<ul>
<li>“GrLivArea”更大的两个值看起来很奇怪，它们并没有随大流。我们可以推测为什么会这样。也许他们指的是农业地区，这可以解释为什么价格这么低。我不确定这一点，但我很有信心，这两点并不能代表典型的案例。因此，我们将它们定义为离群值并删除它们。</li>
<li>图顶端的两个观察结果正是7.的值。我们说过要注意观察到的一些现象。它们看起来像两个特殊的案例，但它们似乎正在遵循这一趋势。因为那个原因，我们会保留它们。</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#删除异常值</span></span><br><span class="line">df_train.sort_values(by = <span class="string">'GrLivArea'</span>,ascending=<span class="keyword">False</span>)[:<span class="number">2</span>]</span><br><span class="line">df_train = df_train.drop(df_train[df_train[<span class="string">'Id'</span>] == <span class="number">1299</span>].index)</span><br><span class="line">df_train = df_train.drop(df_train[df_train[<span class="string">'Id'</span>] == <span class="number">524</span>].index)</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#TotalBsmtSF 和SalePrice的散点图</span></span><br><span class="line">var = <span class="string">'TotalBsmtSF'</span></span><br><span class="line">data = pd.concat([df_train[<span class="string">'SalePrice'</span>],df_train[var]],axis =<span class="number">1</span>)</span><br><span class="line">data.plot.scatter(x=var,y=<span class="string">'SalePrice'</span>,ylim=(<span class="number">0</span>,<span class="number">800000</span>))</span><br></pre></td></tr></table></figure>
<pre><code>&lt;matplotlib.axes._subplots.AxesSubplot at 0x1f1521c4f98&gt;
</code></pre><p><img src="/images/output_37_1.png" alt="png"></p>
<p>我们可能想要删除一些观察结果(例如TotalBsmtSF &gt; 3000)，但我认为这不值得。我们可以忍受，所以我们什么也不做。</p>
<h1 id="关键核心"><a href="#关键核心" class="headerlink" title="关键核心"></a>关键核心</h1><p>检验多元分析的统计基础的假设。我们已经做了一些数据清理，发现了很多关于“SalePrice”的信息。现在是时候深入了解“SalePrice”是如何符合那些使我们能够应用多元技术的统计假设的了。</p>
<ul>
<li>正态性-当我们讨论正态性时我们的意思是数据应该看起来像正态分布。这很重要，因为一些统计测试依赖于此(例如t统计)。在这个练习中，我们将检查“SalePrice”的单变量正态性(这是一种有限的方法)。记住，单变量正态性并不能保证多变量正态性(这正是我们想要的)，但它是有帮助的。另一个需要考虑的细节是，在大样本中(&gt;200次观察)，正态性不是大的问题。然而，如果我们解决了常态，我们就可以避免很多其他问题(比如：异方差性）</li>
<li>同方差-。同方差性是指“假设因变量(s)在预测变量(s)的范围内表现出相同程度的方差”(Hair et al.， 2013)。同方差是可取的，因为我们希望所有自变量的误差项都是相同的。</li>
<li>线性度-评估线性度最常用的方法是检查散点图和搜索线性模式。如果模式不是线性的，则有必要研究数据转换。但是，我们不会深入讨论这个问题，因为我们所看到的散点图似乎都有线性关系。</li>
<li>误差无相关性——自相关，就像定义的，发生在一个误差与另一个误差相关的时候。例如，如果一个误差系统地产生一个负误差，这意味着这些变量之间存在关系。这通常发生在时间序列中，其中一些模式与时间有关。我们也不会深入讨论这个问题。但是，如果您检测到什么，请尝试添加一个变量来解释您所得到的效果。这是相关误差最常见的解决方案。</li>
</ul>
<h1 id="正态检验"><a href="#正态检验" class="headerlink" title="正态检验"></a>正态检验</h1><p>这里的重点是用一种非常精简的方式测试“SalePrice”。我们要注意的是</p>
<ul>
<li>直方图，峰度和偏度。</li>
<li>正态概率图 数据分布应紧跟表示正态分布的对角线。</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#直方图 和 正态概率图</span></span><br><span class="line">sns.distplot(df_train[<span class="string">'SalePrice'</span>],fit=norm)</span><br><span class="line">fig = plt.figure()</span><br><span class="line">res = stats.probplot(df_train[<span class="string">'SalePrice'</span>],plot=plt)</span><br></pre></td></tr></table></figure>
<pre><code>C:\Users\35038\Anaconda3\lib\site-packages\scipy\stats\stats.py:1713: FutureWarning: Using a non-tuple sequence for multidimensional indexing is deprecated; use `arr[tuple(seq)]` instead of `arr[seq]`. In the future this will be interpreted as an array index, `arr[np.array(seq)]`, which will result either in an error or a different result.
  return np.add.reduce(sorted[indexer] * weights, axis=axis) / sumval
</code></pre><p><img src="/images/output_41_1.png" alt="png"></p>
<p><img src="/images/output_41_2.png" alt="png"></p>
<p>‘SalePrice’不正态。 它显示“峰值”，正偏斜并且不跟随对角线。</p>
<p>但一切都没有丢失。 简单的数据转换可以解决问题。<br>这是你可以在统计书中学到的很棒的东西之一：如果是正偏斜，对数转换通常很有效。  </p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#采取对数转换</span></span><br><span class="line">df_train[<span class="string">'SalePrice'</span>] = np.log(df_train[<span class="string">'SalePrice'</span>])</span><br><span class="line"><span class="comment">#再次画图</span></span><br><span class="line"><span class="comment">#直方图 和 正态概率图</span></span><br><span class="line">sns.distplot(df_train[<span class="string">'SalePrice'</span>],fit=norm)</span><br><span class="line">fig = plt.figure()</span><br><span class="line">res = stats.probplot(df_train[<span class="string">'SalePrice'</span>],plot=plt)</span><br></pre></td></tr></table></figure>
<pre><code>C:\Users\35038\Anaconda3\lib\site-packages\scipy\stats\stats.py:1713: FutureWarning: Using a non-tuple sequence for multidimensional indexing is deprecated; use `arr[tuple(seq)]` instead of `arr[seq]`. In the future this will be interpreted as an array index, `arr[np.array(seq)]`, which will result either in an error or a different result.
  return np.add.reduce(sorted[indexer] * weights, axis=axis) / sumval
</code></pre><p><img src="/images/output_43_1.png" alt="png"></p>
<p><img src="/images/output_43_2.png" alt="png"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#对’GrLivArea‘的检验</span></span><br><span class="line">sns.distplot(df_train[<span class="string">'GrLivArea'</span>],fit=norm)</span><br><span class="line">fig = plt.figure()</span><br><span class="line">res = stats.probplot(df_train[<span class="string">'GrLivArea'</span>],plot=plt)</span><br></pre></td></tr></table></figure>
<pre><code>C:\Users\35038\Anaconda3\lib\site-packages\scipy\stats\stats.py:1713: FutureWarning: Using a non-tuple sequence for multidimensional indexing is deprecated; use `arr[tuple(seq)]` instead of `arr[seq]`. In the future this will be interpreted as an array index, `arr[np.array(seq)]`, which will result either in an error or a different result.
  return np.add.reduce(sorted[indexer] * weights, axis=axis) / sumval
</code></pre><p><img src="/images/output_44_1.png" alt="png"></p>
<p><img src="/images/output_44_2.png" alt="png"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#同样数据转换 再画图</span></span><br><span class="line">df_train[<span class="string">'GrLivArea'</span>] = np.log(df_train[<span class="string">'GrLivArea'</span>])</span><br><span class="line">sns.distplot(df_train[<span class="string">'GrLivArea'</span>],fit=norm)</span><br><span class="line">fig = plt.figure()</span><br><span class="line">res = stats.probplot(df_train[<span class="string">'GrLivArea'</span>],plot=plt)</span><br></pre></td></tr></table></figure>
<pre><code>C:\Users\35038\Anaconda3\lib\site-packages\scipy\stats\stats.py:1713: FutureWarning: Using a non-tuple sequence for multidimensional indexing is deprecated; use `arr[tuple(seq)]` instead of `arr[seq]`. In the future this will be interpreted as an array index, `arr[np.array(seq)]`, which will result either in an error or a different result.
  return np.add.reduce(sorted[indexer] * weights, axis=axis) / sumval
</code></pre><p><img src="/images/output_45_1.png" alt="png"></p>
<p><img src="/images/output_45_2.png" alt="png"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#对‘TotalBsmtSF'检验</span></span><br><span class="line">sns.distplot(df_train[<span class="string">'TotalBsmtSF'</span>],fit=norm)</span><br><span class="line">fig = plt.figure()</span><br><span class="line">res = stats.probplot(df_train[<span class="string">'TotalBsmtSF'</span>],plot=plt)</span><br></pre></td></tr></table></figure>
<pre><code>C:\Users\35038\Anaconda3\lib\site-packages\scipy\stats\stats.py:1713: FutureWarning: Using a non-tuple sequence for multidimensional indexing is deprecated; use `arr[tuple(seq)]` instead of `arr[seq]`. In the future this will be interpreted as an array index, `arr[np.array(seq)]`, which will result either in an error or a different result.
  return np.add.reduce(sorted[indexer] * weights, axis=axis) / sumval
</code></pre><p><img src="/images/output_46_1.png" alt="png"></p>
<p><img src="/images/output_46_2.png" alt="png"></p>
<ul>
<li>总的来说，呈现偏态的东西。</li>
<li>大量观测值为零(没有地下室的房屋)。</li>
<li>这是个大问题，因为0值不允许我们做对数变换。<br>要在此处应用对数转换，我们将创建一个可以获得具有或不具有基础（二进制变量）的效果的变量。 然后，我们将对所有非零观测值进行对数变换，忽略值为零的观测值。 这样我们就可以转换数据，而不会失去有或没有地下室的影响。</li>
</ul>
<p>我不确定这种方法是否正确。 这对我来说似乎是对的。 这就是我所谓的“高风险工程”</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#创建一个新变量</span></span><br><span class="line"><span class="comment">#area&gt;0 则为1，area==0，则为0</span></span><br><span class="line">df_train[<span class="string">'HasBsmt'</span>] = pd.Series(len(df_train[<span class="string">'TotalBsmtSF'</span>]),index=df_train.index)</span><br><span class="line">df_train[<span class="string">'HasBsmt'</span>] = <span class="number">0</span></span><br><span class="line">df_train.loc[df_train[<span class="string">'TotalBsmtSF'</span>]&gt;<span class="number">0</span> ,<span class="string">'HasBsmt'</span>]=<span class="number">1</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#再转换数据 画图</span></span><br><span class="line">df_train.loc[df_train[<span class="string">'HasBsmt'</span>] ==<span class="number">1</span>,<span class="string">'TotalBsmtSF'</span>] = np.log(df_train[<span class="string">'TotalBsmtSF'</span>])</span><br><span class="line">sns.distplot(df_train[df_train[<span class="string">'TotalBsmtSF'</span>] &gt;<span class="number">0</span>][<span class="string">'TotalBsmtSF'</span>] ,fit=norm)   <span class="comment">#只画大于0的那些数据</span></span><br><span class="line">fig = plt.figure()</span><br><span class="line">res = stats.probplot(df_train[df_train[<span class="string">'TotalBsmtSF'</span>] &gt;<span class="number">0</span>][<span class="string">'TotalBsmtSF'</span>],plot=plt)</span><br></pre></td></tr></table></figure>
<pre><code>C:\Users\35038\Anaconda3\lib\site-packages\ipykernel_launcher.py:8: RuntimeWarning: divide by zero encountered in log

C:\Users\35038\Anaconda3\lib\site-packages\scipy\stats\stats.py:1713: FutureWarning: Using a non-tuple sequence for multidimensional indexing is deprecated; use `arr[tuple(seq)]` instead of `arr[seq]`. In the future this will be interpreted as an array index, `arr[np.array(seq)]`, which will result either in an error or a different result.
  return np.add.reduce(sorted[indexer] * weights, axis=axis) / sumval
</code></pre><p><img src="/images/output_48_1.png" alt="png"></p>
<p><img src="/images/output_48_2.png" alt="png"></p>
<h1 id="同方差检验"><a href="#同方差检验" class="headerlink" title="同方差检验"></a>同方差检验</h1><p>测试两个度量变量的同方差的最佳方法是用图形表示。偏离相同色散的形状有圆锥(图的一边小色散，另一边大色散)或菱形(分布中心的大量点)。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">plt.scatter(df_train[<span class="string">'GrLivArea'</span>],df_train[<span class="string">'SalePrice'</span>])</span><br></pre></td></tr></table></figure>
<pre><code>&lt;matplotlib.collections.PathCollection at 0x1f152622c50&gt;
</code></pre><p><img src="/images/output_50_1.png" alt="png"></p>
<p>此散点图的旧版本（在对数转换之前）具有圆锥形状（返回并检查’SalePrice’和相关变量之间的散点图（像Jagger样式一样移动）’）。<br>如您所见，当前的散点图不再具有圆锥形状。 这是正态化的力量！ 只是通过确保某些变量的正常性，我们解决了同方差性问题</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">plt.scatter(df_train[df_train[<span class="string">'TotalBsmtSF'</span>]&gt;<span class="number">0</span>][<span class="string">'TotalBsmtSF'</span>],df_train[df_train[<span class="string">'TotalBsmtSF'</span>]&gt;<span class="number">0</span>][<span class="string">'SalePrice'</span>])</span><br><span class="line"><span class="comment">#保证同数据</span></span><br></pre></td></tr></table></figure>
<pre><code>&lt;matplotlib.collections.PathCollection at 0x1f14c7f1f98&gt;
</code></pre><p><img src="/images/output_52_1.png" alt="png"></p>
<p>可以看到SalePrice’在’TotalBsmtSF ‘范围内显示出相同水平的差异</p>
<h1 id="虚拟变量"><a href="#虚拟变量" class="headerlink" title="虚拟变量"></a>虚拟变量</h1><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#将类别变量转化为虚拟变量</span></span><br><span class="line">df_train = pd.get_dummies(df_train)</span><br></pre></td></tr></table></figure>
<p>我们单独分析了’SalePrice’并且使用最相关的变量，我们处理了缺失数据和异常值，我们测试了一些基本的统计假设，我们甚至将分类变量转换为虚拟变量。 这是Python帮助我们轻松完成的大量工作。</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/12/03/项目2.视频网站数据/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="萨尔茨堡的树枝">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar1.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="DnoBlog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/12/03/项目2.视频网站数据/" itemprop="url">项目学习2.视频网站数据清洗整理</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-12-03T12:52:00+08:00">
                2018-12-03
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/数据分析/" itemprop="url" rel="index">
                    <span itemprop="name">数据分析</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          
            <div class="post-wordcount">
              
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">字数统计&#58;</span>
                
                <span title="字数统计">
                  2,364
                </span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">阅读时长 &asymp;</span>
                
                <span title="阅读时长">
                  10
                </span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np </span><br><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line">%matplotlib inline</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#读取数据</span></span><br><span class="line">data = pd.read_csv(<span class="string">r'...path\爱奇艺视频数据.csv'</span>,engine = <span class="string">'python'</span>)</span><br><span class="line"><span class="comment">#print(data.head())</span></span><br><span class="line"></span><br><span class="line"><span class="string">'''1、数据清洗 - 去除空值</span></span><br><span class="line"><span class="string">要求：创建函数</span></span><br><span class="line"><span class="string">提示：fillna方法填充缺失数据，注意inplace参数'''</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">data_cleaning</span><span class="params">(df)</span>:</span></span><br><span class="line">    cols = df.columns</span><br><span class="line">    <span class="keyword">for</span> col <span class="keyword">in</span> cols:</span><br><span class="line">        <span class="keyword">if</span> df[col].dtype == <span class="string">'object'</span>:         <span class="comment">#数据类型的判断</span></span><br><span class="line">            df[col].fillna(<span class="string">'缺失数据'</span>,inplace=<span class="keyword">True</span>)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            df[col].fillna(<span class="number">0</span>,inplace=<span class="keyword">True</span>)</span><br><span class="line">    <span class="keyword">return</span>(df)</span><br><span class="line">data_c = data_cleaning(data)        </span><br><span class="line">print(data_c.head(<span class="number">3</span>))</span><br></pre></td></tr></table></figure>
<pre><code>       数据获取日期    演员  视频ID                                        详细链接  \
0  2016年5月24日  缺失数据   100  http://www.iqiyi.com/dianshiju/douyu2.html   
1  2016年5月24日  缺失数据  1037   http://www.iqiyi.com/dianshiju/jhuxd.html   
2  2016年5月24日  缺失数据  1573  http://www.iqiyi.com/dianshiju/fmxqj2.html   

               剧名   状态                     类型 来源平台     整理后剧名  更新时间   ...     \
0     斗鱼Ⅱ(1-20)全集  已完结  粤语电视剧/偶像剧/言情剧/超清1080P  爱奇艺       斗鱼2  缺失数据   ...      
1    江湖兄弟(1-32)全集  已完结  粤语电视剧/悬疑剧/年代剧/超清1080P  爱奇艺    江湖兄弟全集  缺失数据   ...      
2  肥猫寻亲记2(1-30)全集  已完结           粤语电视剧/家庭剧/喜剧  爱奇艺  肥猫寻亲记2全集  缺失数据   ...      

     上映年份                                                 简介    导演     差评数  \
0  2004.0  在单子杀了阿豹派去强暴语燕的手下而入狱后，众人的生活都有了改变。语燕为了让自己不再是于皓的包...  缺失数据  2034.0   
1  2008.0  1930年代，海龙城首富唐英明用五斗上等珍珠，击败列国商业对手，买得与铁达尼齐名之奥丽号邮轮...  缺失数据  7291.0   
2  2005.0  肥猫经历了几番风雨，终于寻回了他的亲生弟妹们：年轻有为的医生二弟华世杰、大律师三妹婉容、美丽...  缺失数据  1183.0   

      评分人数         播放量  更新至   总集数  第几季      好评数  
0  32722.0   8069526.0  0.0  20.0    2  30688.0  
1  39492.0  70213917.0  0.0  32.0    1  32201.0  
2  10105.0   3310768.0  0.0  30.0    1   8922.0  

[3 rows x 24 columns]
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">'''2、数据清洗 - 时间标签转化</span></span><br><span class="line"><span class="string">要求：</span></span><br><span class="line"><span class="string">① 将时间字段改为时间标签</span></span><br><span class="line"><span class="string">② 创建函数</span></span><br><span class="line"><span class="string">提示：</span></span><br><span class="line"><span class="string">需要将中文日期转化为非中文日期，例如 2016年5月24日 → 2016.5.24'''</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">timechange</span><span class="params">(df,*cols)</span>:</span></span><br><span class="line">    <span class="keyword">for</span> col <span class="keyword">in</span> cols:</span><br><span class="line">        df[col] = df[col].astype(str).str.replace(<span class="string">'年'</span>,<span class="string">'.'</span>)     <span class="comment">#.astype(str).str.replace</span></span><br><span class="line">        df[col] = df[col].astype(str).str.replace(<span class="string">'月'</span>,<span class="string">'.'</span>)</span><br><span class="line">        df[col] = df[col].astype(str).str.replace(<span class="string">'日'</span>,<span class="string">''</span>)</span><br><span class="line">        df[col] = pd.to_datetime(df[col])</span><br><span class="line">    <span class="keyword">return</span>(df)</span><br><span class="line"><span class="comment"># 该函数将输入列名的列，改为DatetimeIndex格式</span></span><br><span class="line"></span><br><span class="line">data_c2 = timechange(data_c,<span class="string">'数据获取日期'</span>)</span><br><span class="line">print(data_c2.head(<span class="number">3</span>))</span><br></pre></td></tr></table></figure>
<pre><code>      数据获取日期    演员  视频ID                                        详细链接  \
0 2016-05-24  缺失数据   100  http://www.iqiyi.com/dianshiju/douyu2.html   
1 2016-05-24  缺失数据  1037   http://www.iqiyi.com/dianshiju/jhuxd.html   
2 2016-05-24  缺失数据  1573  http://www.iqiyi.com/dianshiju/fmxqj2.html   

               剧名   状态                     类型 来源平台     整理后剧名  更新时间   ...     \
0     斗鱼Ⅱ(1-20)全集  已完结  粤语电视剧/偶像剧/言情剧/超清1080P  爱奇艺       斗鱼2  缺失数据   ...      
1    江湖兄弟(1-32)全集  已完结  粤语电视剧/悬疑剧/年代剧/超清1080P  爱奇艺    江湖兄弟全集  缺失数据   ...      
2  肥猫寻亲记2(1-30)全集  已完结           粤语电视剧/家庭剧/喜剧  爱奇艺  肥猫寻亲记2全集  缺失数据   ...      

     上映年份                                                 简介    导演     差评数  \
0  2004.0  在单子杀了阿豹派去强暴语燕的手下而入狱后，众人的生活都有了改变。语燕为了让自己不再是于皓的包...  缺失数据  2034.0   
1  2008.0  1930年代，海龙城首富唐英明用五斗上等珍珠，击败列国商业对手，买得与铁达尼齐名之奥丽号邮轮...  缺失数据  7291.0   
2  2005.0  肥猫经历了几番风雨，终于寻回了他的亲生弟妹们：年轻有为的医生二弟华世杰、大律师三妹婉容、美丽...  缺失数据  1183.0   

      评分人数         播放量  更新至   总集数  第几季      好评数  
0  32722.0   8069526.0  0.0  20.0    2  30688.0  
1  39492.0  70213917.0  0.0  32.0    1  32201.0  
2  10105.0   3310768.0  0.0  30.0    1   8922.0  

[3 rows x 24 columns]
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">'''3、问题1 分析出不同导演电影的好评率，并筛选出TOP20</span></span><br><span class="line"><span class="string">要求：</span></span><br><span class="line"><span class="string">① 计算统计出不同导演的好评率，不要求创建函数</span></span><br><span class="line"><span class="string">② 通过多系列柱状图，做图表可视化</span></span><br><span class="line"><span class="string">提示：</span></span><br><span class="line"><span class="string">① 好评率 = 好评数 / 评分人数</span></span><br><span class="line"><span class="string">② 可自己设定图表风格'''</span></span><br><span class="line"></span><br><span class="line">data_director = data_c2.groupby(<span class="string">'导演'</span>).sum()[[<span class="string">'好评数'</span>,<span class="string">'评分人数'</span>]]</span><br><span class="line">data_director[<span class="string">'好评率'</span>] = data_director[<span class="string">'好评数'</span>]/data_director[<span class="string">'评分人数'</span>]</span><br><span class="line">result_q1 = data_director.sort_values([<span class="string">'好评率'</span>],ascending=<span class="keyword">False</span>)[:<span class="number">20</span>]   <span class="comment">#前20名</span></span><br><span class="line"><span class="comment">#计算统计不同导演的好评率</span></span><br><span class="line">print(result_q1)</span><br><span class="line"></span><br><span class="line">result_q1[<span class="string">'好评率'</span>].plot(kind=<span class="string">'bar'</span>,</span><br><span class="line">                     color = <span class="string">'k'</span>,</span><br><span class="line">                     width = <span class="number">0.8</span>,</span><br><span class="line">                     alpha = <span class="number">0.4</span>,</span><br><span class="line">                     rot =<span class="number">45</span>,</span><br><span class="line">                     grid = <span class="keyword">True</span>,</span><br><span class="line">                     ylim = [<span class="number">0.98</span>,<span class="number">1</span>],</span><br><span class="line">                     figsize=(<span class="number">12</span>,<span class="number">4</span>),</span><br><span class="line">                     title = <span class="string">'不同导演的电影好评率'</span>)</span><br></pre></td></tr></table></figure>
<pre><code>                  好评数          评分人数       好评率
导演                                           
王静       5.601448e+06  5.602704e+06  0.999776
萧锋       4.415545e+07  4.416801e+07  0.999716
向灼       3.685386e+06  3.691240e+06  0.998414
乌兰塔娜     1.916524e+07  1.920091e+07  0.998142
徐宗政      3.113422e+06  3.123920e+06  0.996639
欧凡       3.088701e+06  3.100421e+06  0.996220
肖光辉      3.264290e+05  3.284140e+05  0.993956
张国立/罗长安  8.177111e+06  8.230880e+06  0.993467
刘逢声/林峰   3.591638e+06  3.617351e+06  0.992892
林添一      1.049628e+09  1.057556e+09  0.992504
毛尉光      1.747925e+06  1.766237e+06  0.989632
郭东旭      1.027664e+06  1.039609e+06  0.988510
苏沅峰/张艺腾  3.600976e+06  3.643071e+06  0.988445
袁刚/成志超   1.185439e+07  1.200596e+07  0.987375
胡雪杨      1.042170e+06  1.056247e+06  0.986673
丁晓雄      1.568219e+06  1.591727e+06  0.985231
延艺       4.094535e+07  4.157757e+07  0.984794
潇庸       5.338679e+06  5.427978e+06  0.983548
白羽/陈迅    1.705608e+07  1.737295e+07  0.981761
张蠡/姜峰    2.100617e+08  2.143382e+08  0.980047





&lt;matplotlib.axes._subplots.AxesSubplot at 0x207629e5ac8&gt;
</code></pre><p><img src="/images/2_1.png" alt="png"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">'''4、问题2 统计分析2001-2016年每年评影人数总量</span></span><br><span class="line"><span class="string">要求：</span></span><br><span class="line"><span class="string">① 计算统计出2001-2016年每年评影人数总量，不要求创建函数</span></span><br><span class="line"><span class="string">② 通过面积图，做图表可视化，分析每年人数总量变化规律</span></span><br><span class="line"><span class="string">③ 验证是否有异常值（极度异常）</span></span><br><span class="line"><span class="string">④ 创建函数分析出数据外限最大最小值）</span></span><br><span class="line"><span class="string">⑤ 筛选查看异常值 → 是否异常值就是每年的热门电影？</span></span><br><span class="line"><span class="string">提示：</span></span><br><span class="line"><span class="string">① 通过箱型图验证异常值情况</span></span><br><span class="line"><span class="string">② 通过quantile(q=0.5)方法，得到四分位数</span></span><br><span class="line"><span class="string">③ IQR=Q3-Q1</span></span><br><span class="line"><span class="string">④ 外限：最大值区间Q3+3IQR,最小值区间Q1-3IQR （IQR=Q3-Q1）</span></span><br><span class="line"><span class="string">⑤ 可自己设定图表风格'''</span></span><br><span class="line"></span><br><span class="line">data_year = data_c2[[<span class="string">'导演'</span>,<span class="string">'上映年份'</span>,<span class="string">'整理后剧名'</span>]].drop_duplicates()</span><br><span class="line">data_year = data_year[data_year[<span class="string">'上映年份'</span>] != <span class="number">0</span> ]</span><br><span class="line"><span class="comment"># 筛选出不同年份的数据，去除‘上映年份’字段缺失数据</span></span><br><span class="line">print(data_year.head())</span><br><span class="line"></span><br><span class="line">data_year1 = data_c2.groupby(<span class="string">'整理后剧名'</span>).sum()[[<span class="string">'评分人数'</span>,<span class="string">'好评数'</span>]]</span><br><span class="line">print(data_year1.head())</span><br><span class="line"><span class="comment"># 求出不同剧的评分人数、好评数总和</span></span><br><span class="line"></span><br><span class="line">data_year2 = pd.merge(data_year,data_year1,left_on=<span class="string">'整理后剧名'</span>,right_index = <span class="keyword">True</span>)</span><br><span class="line">print(data_year2.head())</span><br><span class="line"><span class="comment"># 合并数据，得到不同年份，不同剧的评分人数、好评数总和</span></span><br><span class="line"></span><br><span class="line">data_year3 = data_year2.groupby(<span class="string">'上映年份'</span>).sum()[[<span class="string">'评分人数'</span>,<span class="string">'好评数'</span>]]</span><br><span class="line">print(data_year3.head())</span><br><span class="line"></span><br><span class="line">figq = plt.figure(figsize=(<span class="number">12</span>,<span class="number">4</span>))</span><br><span class="line">data_year3[<span class="string">'评分人数'</span>].loc[<span class="number">2000</span>:].plot.area(figsize= (<span class="number">10</span>,<span class="number">4</span>),        <span class="comment">#2000年后的数据</span></span><br><span class="line">                                       grid = <span class="keyword">True</span>,</span><br><span class="line">                                       color = <span class="string">'g'</span>,</span><br><span class="line">                                       alpha= <span class="number">0.8</span>)</span><br><span class="line">plt.xticks(range(<span class="number">2001</span>,<span class="number">2016</span>))</span><br><span class="line">plt.title(<span class="string">'2001-2016年每年评影人数总量统计'</span>)</span><br><span class="line"><span class="comment"># 创建面积图</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 每年影评人数通过每个电影来判断是否合理？</span></span><br><span class="line"><span class="comment"># 存在异常值，哪些是异常值？</span></span><br><span class="line">fig,axes = plt.subplots(<span class="number">4</span>,<span class="number">4</span>,figsize=(<span class="number">10</span>,<span class="number">16</span>))</span><br><span class="line">start =<span class="number">2001</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">4</span>):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> range(<span class="number">4</span>):</span><br><span class="line">        data = data_year2[data_year2[<span class="string">'上映年份'</span>] == start]</span><br><span class="line">        data[[<span class="string">'评分人数'</span>,<span class="string">'好评数'</span>]].boxplot(whis = <span class="number">3</span>,<span class="comment"># IQR为3</span></span><br><span class="line">                                    return_type=<span class="string">'dict'</span>,ax=axes[i,j])<span class="comment"># 创建矩阵箱型图</span></span><br><span class="line">        start += <span class="number">1</span></span><br><span class="line"><span class="comment"># 发现基本每年的数据中都有异常值，且为极度异常</span></span><br></pre></td></tr></table></figure>
<pre><code>     导演    上映年份     整理后剧名
0  缺失数据  2004.0       斗鱼2
1  缺失数据  2008.0    江湖兄弟全集
2  缺失数据  2005.0  肥猫寻亲记2全集
3  缺失数据  2006.0    舞台姐妹全集
4  缺失数据  2007.0   18禁不禁全集
                      评分人数        好评数
整理后剧名                                
101网校高考历史冲刺考点解析       90.0       78.0
10品官吴山羊            57715.0    38736.0
10大奇冤            3002099.0  2801151.0
10天10夜             18209.0    11299.0
10指连心              14852.0    10617.0
     导演    上映年份     整理后剧名        评分人数         好评数
0  缺失数据  2004.0       斗鱼2   1488378.0   1398674.0
1  缺失数据  2008.0    江湖兄弟全集   1809908.0   1477701.0
2  缺失数据  2005.0  肥猫寻亲记2全集    461860.0    407507.0
3  缺失数据  2006.0    舞台姐妹全集    120525.0     99885.0
4  缺失数据  2007.0   18禁不禁全集  34402833.0  31482452.0
             评分人数        好评数
上映年份                        
1937.0    84367.0    63120.0
1985.0   163064.0   135462.0
1986.0    58593.0    41216.0
1987.0  3930018.0  3728651.0
1988.0   410722.0   337484.0
</code></pre><p><img src="/images/2_2.png" alt="png"></p>
<p><img src="/images/2_3.png" alt="png"></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/12/01/项目1.知乎数据清洗整理和结论研究/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="萨尔茨堡的树枝">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar1.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="DnoBlog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/12/01/项目1.知乎数据清洗整理和结论研究/" itemprop="url">项目学习1.知乎数据清洗整理和结论研究</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-12-01T18:52:00+08:00">
                2018-12-01
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/数据分析/" itemprop="url" rel="index">
                    <span itemprop="name">数据分析</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          
            <div class="post-wordcount">
              
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">字数统计&#58;</span>
                
                <span title="字数统计">
                  1,398
                </span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">阅读时长 &asymp;</span>
                
                <span title="阅读时长">
                  7
                </span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line">% matplotlib inline</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#数据读取</span></span><br><span class="line"></span><br><span class="line">data1 = pd.read_csv(<span class="string">r'...path\知乎数据_201701.csv'</span>, engine = <span class="string">'python'</span>)</span><br><span class="line">data2 = pd.read_csv(<span class="string">r'...path\六普常住人口数.csv'</span>, engine = <span class="string">'python'</span>)</span><br><span class="line">print(data1.head())</span><br><span class="line">print(data2.head())</span><br></pre></td></tr></table></figure>
<pre><code>                        _id  关注的收藏夹   关注  关注者  关注的问题  关注的话题  关注的专栏   职业1  \
0  587598f89f11daf90617fb7a      52   17    1     30     58      2  交通仓储   
1  587598f89f11daf90617fb7c      27   73   15     87     26      1  高新科技   
2  587598f89f11daf90617fb7e      72   94    1    112     20      4   NaN   
3  587598f89f11daf90617fb80     174   84    8    895     30      7    金融   
4  587598f89f11daf90617fb82       3  236   64    119     44     17    金融   

    职业2    回答   提问    收藏       个人简介  居住地  所在行业                       教育经历 职业经历  
0    邮政   0.0  0.0   3.0        NaN  NaN    邮政                        NaN  NaN  
1   互联网  56.0  4.0  14.0        NaN   重庆   互联网                     重庆邮电大学  NaN  
2   NaN   1.0  0.0  21.0        NaN  NaN   NaN                        NaN  NaN  
3    财务   0.0  0.0  22.0        NaN  NaN    财务                        NaN  NaN  
4  证券投资   6.0  0.0  12.0  无求 心静 魔不生   上海  证券投资  雪城大学（Syracuse University）  NaN  
     省   地区 结尾        常住人口
0  安徽省  安徽省  省  59500468.0
1  安徽省  安庆市  市   5311379.0
2  安徽省  蚌埠市  市   3164467.0
3  安徽省  亳州市  市   4850657.0
4  安徽省  巢湖市  市   3873102.0
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#数据清洗 - 去除空值</span></span><br><span class="line"><span class="comment">#文本型字段空值改成“缺失数据”，数字型字段空值改为0</span></span><br><span class="line"><span class="comment">#要求：创建函数</span></span><br><span class="line"><span class="comment">#提示：fillna方法填充缺失数据，注意inplace参数</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">data_cleaning</span><span class="params">(df)</span>:</span></span><br><span class="line">    cols = df.columns  <span class="comment">#获取列名</span></span><br><span class="line">    <span class="keyword">for</span> col <span class="keyword">in</span> cols:</span><br><span class="line">        <span class="keyword">if</span> df[col].dtype == <span class="string">'object'</span>:       <span class="comment">#数据类型</span></span><br><span class="line">            df[col].fillna(<span class="string">'缺失数据'</span>,inplace=<span class="keyword">True</span>)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            df[col].fillna(<span class="number">0</span>,inplace=<span class="keyword">True</span>)</span><br><span class="line">    <span class="keyword">return</span>(df)</span><br><span class="line">data1_c = data_cleaning(data1)</span><br><span class="line">data1_c.head(<span class="number">3</span>)</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 问题1 知友全国地域分布情况，分析出TOP20</span></span><br><span class="line"><span class="comment"># 要求：</span></span><br><span class="line"><span class="comment"># ① 按照地域统计 知友数量、知友密度（知友数量/城市常住人口），不要求创建函数</span></span><br><span class="line"><span class="comment"># ② 知友数量，知友密度，标准化处理，取值0-100，要求创建函数</span></span><br><span class="line"><span class="comment"># ③ 通过多系列柱状图，做图表可视化</span></span><br><span class="line"><span class="comment"># 提示：</span></span><br><span class="line"><span class="comment"># ① 标准化计算方法 = (X - Xmin) / (Xmax - Xmin)</span></span><br><span class="line"><span class="comment"># ② 可自行设置图表风格</span></span><br><span class="line"></span><br><span class="line">df_city = data1_c.groupby(<span class="string">'居住地'</span>).count()    <span class="comment">#按照居住地统计知友数量</span></span><br><span class="line">data2[<span class="string">'city'</span>] = data2[<span class="string">'地区'</span>].str[:<span class="number">-1</span>]          <span class="comment">#城市信息清洗，去掉城市等级文字</span></span><br><span class="line"><span class="comment">#print(df_city.head())</span></span><br><span class="line"><span class="comment">#print(data2.head())</span></span><br><span class="line"></span><br><span class="line">q1data = pd.merge(df_city,data2,left_index=<span class="keyword">True</span>,right_on=<span class="string">'city'</span>,how=<span class="string">'inner'</span>)[[<span class="string">'_id'</span>,<span class="string">'city'</span>,<span class="string">'常住人口'</span>]]</span><br><span class="line"><span class="comment">#合并两表 </span></span><br><span class="line"></span><br><span class="line">q1data[<span class="string">'知友密度'</span>] = q1data[<span class="string">'_id'</span>]/q1data[<span class="string">'常住人口'</span>]</span><br><span class="line"><span class="comment"># 统计计算知友数量，知友密度</span></span><br><span class="line"><span class="comment">#print(q1data.head())</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">data_nor</span><span class="params">(df,*cols)</span>:</span></span><br><span class="line">    colnames = []</span><br><span class="line">    <span class="keyword">for</span> col <span class="keyword">in</span> cols:</span><br><span class="line">        colname = col +<span class="string">'_nor'</span>          <span class="comment">#新列列名</span></span><br><span class="line">        df[colname] = (df[col]-df[col].min())/(df[col].max()-df[col].min())*<span class="number">100</span></span><br><span class="line">        colnames.append(colname)       <span class="comment">#列名的列表</span></span><br><span class="line">    <span class="keyword">return</span>(df,colnames)</span><br><span class="line"><span class="comment"># 创建函数，结果返回标准化取值</span></span><br><span class="line"></span><br><span class="line">resultdata = data_nor(q1data,<span class="string">'_id'</span>,<span class="string">'知友密度'</span>)[<span class="number">0</span>]      <span class="comment">#新表</span></span><br><span class="line">resultcolnames = data_nor(q1data,<span class="string">'_id'</span>,<span class="string">'知友密度'</span>)[<span class="number">1</span>]  <span class="comment">#列名的列表</span></span><br><span class="line"><span class="comment">#print(resultdata)</span></span><br><span class="line"><span class="comment">#print(resultcolnames)</span></span><br><span class="line">q1data_top20_sl = resultdata.sort_values(resultcolnames[<span class="number">0</span>],ascending=<span class="keyword">False</span>)[[<span class="string">'city'</span>,resultcolnames[<span class="number">0</span>]]].iloc[:<span class="number">20</span>]</span><br><span class="line">q1data_top20_md = resultdata.sort_values(resultcolnames[<span class="number">1</span>],ascending=<span class="keyword">False</span>)[[<span class="string">'city'</span>,resultcolnames[<span class="number">1</span>]]].iloc[:<span class="number">20</span>]</span><br><span class="line"><span class="comment">#先排序 选字段 按位置索引</span></span><br><span class="line"><span class="comment"># 标准化取值后得到知友数量，知友密度的TOP20数据</span></span><br><span class="line">print(q1data_top20_sl)</span><br><span class="line"></span><br><span class="line"><span class="comment">#做图</span></span><br><span class="line">fig1 = plt.figure(num=<span class="number">1</span>,figsize=(<span class="number">12</span>,<span class="number">4</span>))</span><br><span class="line">y1 = q1data_top20_sl[resultcolnames[<span class="number">0</span>]]</span><br><span class="line">plt.bar(range(<span class="number">20</span>),</span><br><span class="line">       y1,</span><br><span class="line">       width = <span class="number">0.8</span>,</span><br><span class="line">       facecolor = <span class="string">'yellowgreen'</span>,</span><br><span class="line">       edgecolor = <span class="string">'k'</span>,</span><br><span class="line">       tick_label = q1data_top20_sl[<span class="string">'city'</span>])</span><br><span class="line">plt.title(<span class="string">'知友数量TOP20\n'</span>)</span><br><span class="line">plt.grid(<span class="keyword">True</span>, linestyle = <span class="string">"--"</span>,color = <span class="string">"gray"</span>, axis = <span class="string">'y'</span>,linewidth=<span class="number">0.5</span>)  </span><br><span class="line"><span class="keyword">for</span> i,j <span class="keyword">in</span> zip(range(<span class="number">20</span>),y1):</span><br><span class="line">    plt.text(i<span class="number">-0.4</span>,<span class="number">2</span>,<span class="string">'%.1f'</span> % j,color = <span class="string">'k'</span>,fontsize = <span class="number">9</span>)</span><br><span class="line"></span><br><span class="line">fig2 = plt.figure(num=<span class="number">2</span>,figsize=(<span class="number">12</span>,<span class="number">4</span>))</span><br><span class="line">y2 = q1data_top20_md[resultcolnames[<span class="number">1</span>]]</span><br><span class="line">plt.bar(range(<span class="number">20</span>),</span><br><span class="line">        y2,</span><br><span class="line">        width = <span class="number">0.8</span>,</span><br><span class="line">        facecolor = <span class="string">'lightskyblue'</span>,</span><br><span class="line">        edgecolor = <span class="string">'k'</span>,</span><br><span class="line">        tick_label = q1data_top20_md[<span class="string">'city'</span>])</span><br><span class="line">plt.grid(<span class="keyword">True</span>, linestyle = <span class="string">"--"</span>,color = <span class="string">"gray"</span>, linewidth = <span class="number">0.5</span>, axis = <span class="string">'y'</span>)  </span><br><span class="line">plt.title(<span class="string">'知友密度TOP20\n'</span>)</span><br><span class="line"><span class="keyword">for</span> i,j <span class="keyword">in</span> zip(range(<span class="number">20</span>),y2):</span><br><span class="line">    plt.text(i<span class="number">-0.4</span>,<span class="number">2</span>,<span class="string">'%.1f'</span> % j,color=<span class="string">'k'</span>,fontsize=<span class="number">9</span>)</span><br></pre></td></tr></table></figure>
<pre><code>    city     _id_nor
23    北京  100.000000
72    广东   94.017279
565   上海   73.779698
363   江苏   47.192225
672   浙江   41.403888
268   湖北   27.105832
591   四川   26.673866
511   山东   24.362851
556   陕西   19.114471
26    福建   19.028078
192   河南   15.183585
301   湖南   12.850972
675   重庆   11.663067
599   天津   10.755940
434   辽宁   10.734341
0     安徽    9.589633
164   河北    7.840173
236  黑龙江    6.177106
401   江西    5.982721
541   山西    5.442765
</code></pre><p><img src="/images/1_1.png" alt="png"></p>
<p><img src="/images/1_2.png" alt="png"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 问题2 不同高校知友关注和被关注情况</span></span><br><span class="line"><span class="comment"># 要求：</span></span><br><span class="line"><span class="comment"># ① 按照学校（教育经历字段） 统计粉丝数（‘关注者’）、关注人数（‘关注’），并筛选出粉丝数TOP20的学校，不要求创建函数</span></span><br><span class="line"><span class="comment"># ② 通过散点图 → 横坐标为关注人数，纵坐标为粉丝数，做图表可视化</span></span><br><span class="line"><span class="comment"># ③ 散点图中，标记出平均关注人数（x参考线），平均粉丝数（y参考线）</span></span><br><span class="line"><span class="comment"># 提示：</span></span><br><span class="line"><span class="comment"># ① 可自行设置图表风格</span></span><br><span class="line"></span><br><span class="line">q2data = data1_c.groupby(<span class="string">'教育经历'</span>).sum()[[<span class="string">'关注'</span>,<span class="string">'关注者'</span>]].drop([<span class="string">'缺失数据'</span>,<span class="string">'大学'</span>,<span class="string">'本科'</span>])</span><br><span class="line">q2data_c = q2data.sort_values(<span class="string">'关注'</span>,ascending=<span class="keyword">False</span>)[:<span class="number">20</span>]</span><br><span class="line"><span class="comment">#print(q2data_c)</span></span><br><span class="line"></span><br><span class="line">plt.figure(figsize=(<span class="number">10</span>,<span class="number">6</span>))</span><br><span class="line">x = q2data_c[<span class="string">'关注'</span>]</span><br><span class="line">y = q2data_c[<span class="string">'关注者'</span>]</span><br><span class="line">follow_mean = q2data_c[<span class="string">'关注'</span>].mean()</span><br><span class="line">fans_mean = q2data_c[<span class="string">'关注者'</span>].mean()</span><br><span class="line">plt.scatter(x,y,marker=<span class="string">'.'</span>,</span><br><span class="line">           s = y/<span class="number">1000</span>,</span><br><span class="line">           cmap = <span class="string">'Blues'</span>,</span><br><span class="line">           alpha = <span class="number">0.6</span>,</span><br><span class="line">           label = <span class="string">'学校'</span>)</span><br><span class="line"><span class="comment">#创建散点图</span></span><br><span class="line"></span><br><span class="line">plt.axvline(follow_mean,hold=<span class="keyword">None</span>,label=<span class="string">"平均关注人数： %i人"</span> % follow_mean,color=<span class="string">'r'</span>,linestyle = <span class="string">"--"</span>,alpha=<span class="number">0.8</span>)</span><br><span class="line">plt.axhline(fans_mean,hold=<span class="keyword">None</span>,label=<span class="string">"平均粉丝数： %i人"</span> % fans_mean,color=<span class="string">'g'</span>,linestyle = <span class="string">"--"</span>,alpha=<span class="number">0.8</span>)</span><br><span class="line">plt.legend(loc = <span class="string">'upper left'</span>)</span><br><span class="line"><span class="comment">#添加显示内容</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i,j,n <span class="keyword">in</span> zip(x,y,q2data_c.index):</span><br><span class="line">    plt.text(i+<span class="number">500</span>,j,n,color = <span class="string">'k'</span>)</span><br><span class="line"><span class="comment">#添加注释</span></span><br></pre></td></tr></table></figure>
<p><img src="/images/1_3.png" alt="png"></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/11/30/自我反思/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="萨尔茨堡的树枝">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar1.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="DnoBlog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/11/30/自我反思/" itemprop="url">自我反思</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-11-30T16:00:00+08:00">
                2018-11-30
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/生活炸鸡🐥/" itemprop="url" rel="index">
                    <span itemprop="name">生活炸鸡🐥</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          
            <div class="post-wordcount">
              
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">字数统计&#58;</span>
                
                <span title="字数统计">
                  179
                </span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">阅读时长 &asymp;</span>
                
                <span title="阅读时长">
                  1
                </span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>想学数据相关,坑坑洼洼学着python，却反复只跟着教程或者视频的敲打。碰到项目也只能是模仿而无法自我实践。对于太多东西，只停留在学习和模仿的我，在输出这一块明显不足，时间的流逝带来的是焦虑和徒劳。脑筋不够灵光，在别人看来的努力和冷静只是自我安慰和底线。</p>
<p>想要的方向在哪？想要的生活是什么？<br>每次以<strong>活下去</strong>为底线不断降低标准的自己，又不断看不起自己。<br>看到积极向上的人着实羡慕，自己却渐渐貌似以借口放弃自我。</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
  </section>

  


          </div>
          


          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      

      <section class="site-overview-wrap sidebar-panel sidebar-panel-active">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <img class="site-author-image" itemprop="image"
                src="/images/avatar1.jpg"
                alt="萨尔茨堡的树枝" />
            
              <p class="site-author-name" itemprop="name">萨尔茨堡的树枝</p>
              <p class="site-description motion-element" itemprop="description">好的量变引起质变</p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/archives/">
              
                  <span class="site-state-item-count">5</span>
                  <span class="site-state-item-name">日志</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-categories">
                <a href="/categories/index.html">
                  <span class="site-state-item-count">2</span>
                  <span class="site-state-item-name">分类</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-tags">
                <a href="/tags/index.html">
                  <span class="site-state-item-count">2</span>
                  <span class="site-state-item-name">标签</span>
                </a>
              </div>
            

          </nav>

          

          
            <div class="links-of-author motion-element">
                
                  <span class="links-of-author-item">
                    <a href="https://github.com/Dnotameni" target="_blank" title="GitHub">
                      
                        <i class="fa fa-fw fa-github"></i>GitHub</a>
                  </span>
                
                  <span class="links-of-author-item">
                    <a href="http://weibo.com/Dnohitotsu" target="_blank" title="Weibo">
                      
                        <i class="fa fa-fw fa-weibo"></i>Weibo</a>
                  </span>
                
                  <span class="links-of-author-item">
                    <a href="http://douban.com/people/120827725" target="_blank" title="Douban">
                      
                        <i class="fa fa-fw fa-star"></i>Douban</a>
                  </span>
                
            </div>
          

          
          

          
          

          

        </div>
      </section>

      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        ﻿<script async src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js"></script>

<div class="copyright">&copy; <span itemprop="copyrightYear">2018</span>
  <span class="with-love">
    <i class="fa fa-pagelines"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">萨尔茨堡的树枝</span>

  
</div>



<div class="powered-by">
<i class="fa fa-heart-o"></i>
<span id="busuanzi_container_site_uv">
  本站第<span id="busuanzi_value_site_uv"></span>位天外来客
</span>
</div>

<div class="powered-by">
<span id="timeDate">载入天数...</span><span id="times">载入时分秒...</span>

<script>
    
       var now = new Date(); 

       function createtime() {
       
        var grt= new Date("07/28/2018 17:00:00");//此处修改你的建站时间或者网站上线时间
               now.setTime(now.getTime()+250); 
               days = (now - grt ) / 1000 / 60 / 60 / 24; dnum = Math.floor(days);
       
        hours = (now - grt ) / 1000 / 60 / 60 - (24 * dnum);  hnum = Math.floor(hours); 
       
        if(String(hnum).length ==1 ){hnum = "0" + hnum;} minutes = (now - grt ) / 1000 /60 - (24 * 60 * dnum) - (60 * hnum);
       
        mnum = Math.floor(minutes); if(String(mnum).length ==1 ){mnum = "0" + mnum;}
      
         seconds = (now - grt ) / 1000 - (24 * 60 * 60 * dnum) - (60 * 60 * hnum) - (60 * mnum);
       
        snum = Math.round(seconds); if(String(snum).length ==1 ){snum = "0" + snum;} 
       
        document.getElementById("timeDate").innerHTML = "本站已安全运行 "+dnum+" 天 "; 
       
        document.getElementById("times").innerHTML = hnum + " 小时 " + mnum + " 分 " + snum + " 秒"; 
     
    } 

setInterval("createtime()",250);

</script>
</div>


<!-- <div class="powered-by">由 <a class="theme-link" target="_blank" href="https://hexo.io">Hexo</a> 强力驱动</div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">主题 &mdash; <a class="theme-link" target="_blank" href="https://github.com/iissnan/hexo-theme-next">NexT.Pisces</a> v5.1.4</div>
-->





        







        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  


  











  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>
  

  
  
    <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>
  

  
  
    <script type="text/javascript" src="/lib/canvas-nest/canvas-nest.min.js"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.4"></script>



  
  


  <script type="text/javascript" src="/js/src/affix.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/schemes/pisces.js?v=5.1.4"></script>



  

  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.4"></script>



  


  




	





  





  












  





  

  

  

  
  

  

  

  



<script type="text/javascript"
color="0,0,255" opacity='0.7' zIndex="-2" count="99" src="//cdn.bootcss.com/canvas-nest.js/1.0.0/canvas-nest.min.js"></script>


</body>
</html>
